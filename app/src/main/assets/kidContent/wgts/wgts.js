var xa={};xa.styleMap={title:!0,borderRadiusTopLeft:!0,borderRadiusTopRight:!0,borderRadiusBottomLeft:!0,borderRadiusBottomRight:!0,visibility:!0},xa.editor={},xa.editor.iconThumb="DB/ux/imgs/wgts/thumbs/game.png",xa.scriptInfo={wgtRun:{effect:{ver:2,param:"{area:Array|{x:Number,y:Number}, use:'A1'|'C2'|..., interval:Number|undefined}",help:{ko:"'area'에 해당하는 위치에 '연속 효과'를 표시합니다. 'interval'은 Milisecond로 지정될 수 있으며, 효과간 간격으로 사용됩니다. 값이 undefined이면 편집된 값이 적용됩니다. 'use'는 사용할 '연속 효과'를 지정합니다.",en:"Displays 'chained effect' on positions of 'area'. 'interval' is an interval time(milisecond) between effects. If this is undefined, the edited value will be applied. If there are multiple 'chained effects', you can select by 'use'."}}}},xa.properties={},xa.properties.state="ready",xa.properties.attrs={cfg:{v2D:[{type:"sprinkle",i1:{mediaID:void 0},i2:{mediaID:void 0},i3:{mediaID:void 0},i4:{mediaID:void 0},i5:{mediaID:void 0},id:"",c:30,d:2e3,s:45}],v2A:[{type:"bubble",i1:{mediaID:void 0},i2:{mediaID:void 0},i3:{mediaID:void 0},i4:{mediaID:void 0},i5:{mediaID:void 0},id:"",c:20,d:2e3}],v2C:[{type:"sprinkle",i1:{mediaID:void 0},i2:{mediaID:void 0},i3:{mediaID:void 0},i4:{mediaID:void 0},i5:{mediaID:void 0},id:"",d:0,c:15,imgR:100}]}},xa.exeCreateTag=apn.widgets["apn.wgt.rect"].exeCreateTag,xa.exeRenderTag=apn.widgets["apn.wgt.rect"].exeRenderTag,xa.exeOnLoad=function(e,t){function i(i){if(i&&o&&o.ctx){o.ctx.poolReady=!0;var a;if(o.ctx._uWorksDelayed){for(var r=0;r<o.ctx._uWorksDelayed.length;r++)a=o.ctx._uWorksDelayed[r],"effect"==a.work&&n._effect(e,o,a.type,a.idx);delete o.ctx._uWorksDelayed}if(o._uWorkDelayedRunEffect){for(var r=0;r<o._uWorkDelayedRunEffect.length;r++)a=o._uWorkDelayedRunEffect[r],n.chainEffect(e,o,p.v2C[a.idx],o.ctx.v2imgs["C"+a.idx],a.pts,a.opts);delete o._uWorkDelayedRunEffect}n.exeOnCheckContentLoad&&e.fireEvent("contentLoad","i",t,!0,e.project.property.allowImmediateContentLoad)}}function a(t){var a,n=0,r=0;o.ctx.v2imgs=o.ctx.v2imgs||{};for(var p=0;p<t.length;p++)a=new Image,a.__group=t[p].group,a.onload=function(){var a=o.ctx.v2imgs[this.__group]=o.ctx.v2imgs[this.__group]||[];(void 0===a.__maxImgW||a.__maxImgW<Math.ceil(this.width*(1/e.getZoomX())))&&(a.__maxImgW=Math.ceil(this.width*(1/e.getZoomX()))),(void 0===a.__maxImgH||a.__maxImgH<Math.ceil(this.height*(1/e.getZoomY())))&&(a.__maxImgH=Math.ceil(this.height*(1/e.getZoomY()))),a.push(this),r++,n+r==t.length&&i(r)},a.onerror=a.onabort=function(){n++,n+r==t.length&&i(r)},a.src=t[p].url}var n=this,o=e.wgtTag(t);o.firstChild.style.display="none";var r,p=e.wgtGetProperty(t,"cfg"),d=[],s={A:!0,C:!0,D:!0};for(var c in s)for(var x=0;x<p["v2"+c].length;x++){r=p["v2"+c][x];for(var l=1;l<=5;l++)r["i"+l].mediaID&&d.push({group:c+x,url:e.mediaURL(r["i"+l].mediaID)})}o.ctx={},d.length?a(d):o.ctx.poolReady=!0,o.ctx.apnx=new apnx2(o,parseInt(o.style.width),parseInt(o.style.height),1/e.getZoomX(),1/e.getZoomY())},xa.exeSetState=function(e,t,i){if(t.ctx){e.wgtGetProperty(t.apnOID,"cfg");"D"!=i[0]&&"A"!=i[0]&&"C"!=i[0]||(t.ctx.poolReady?this._effect(e,t,i[0],parseInt(i.substring(2))):(t.ctx._uWorksDelayed=t.ctx._uWorksDelayed||[],t.ctx._uWorksDelayed.push({work:"effect",type:i[0],idx:parseInt(i.substring(2))})))}},xa.exeOnTick=function(e,t,i){var a=e.wgtTag(t);a.ctx&&a.ctx.poolReady&&a.ctx.apnx&&(a.ctx.apnx.count&&a.ctx.apnx.clear(),a.ctx.apnx.run())},xa.exeOnResume=function(e,t){var i=e.wgtTag(t);i.ctx&&i.ctx.apnx&&i.ctx.apnx.resume()},xa.exeOnPause=function(e,t){var i=e.wgtTag(t);i.ctx&&i.ctx.apnx&&i.ctx.apnx.pause()},xa.exeOnCheckContentLoad=function(e,t,i){return{i:"Image"}},xa.exePropSet=function(e,t,i,a,n){if("effect"==i){if(n)return!0;if(a&&a.point&&(a.area=a.point),a&&a.area){var o=e.wgtTag(t),r=e.screen.objects[t].create.data.properties.attrs.cfg,p=a.area,d="C",s=0,c=a.use;if("string"==typeof a.use&&("A"!=a.use[0]&&"D"!=a.use[0]&&"C"!=a.use[0]||(d=a.use[0],a.use=a.use.substring(1))),parseInt(a.use)&&(s=parseInt(a.use)-1),!r["v2"+d][s])return void e.log(t,"Invalid parameter for Widget:run('effect',{...}). use="+c);var x;if(a.clearTR&&a.origin&&a.origin.tag&&a.origin.local&&(x=a.origin),"D"==d||"C"==d){var l,g=!1;if(p instanceof Array?l=p:p instanceof Object&&void 0!==p.x&&void 0!==p.y&&(l=[{x:p.x,y:p.y}],g=!0),l&&l.length)if(a.scene){for(var u=r["v2"+d][s],f=1/e.getZoomX(),v=1/e.getZoomY(),y=0;y<l.length;y++)l[y].x=(l[y].x-e.wgtX(t))*f,l[y].y=(l[y].y-e.wgtY(t))*v;a.scene.call(o.ctx.apnx,o.ctx.v2imgs[d+s],l,{count:u.c,duration:u.d,zoom:u.imgR/100},a.param)}else null!==a.interval&&void 0!==a.interval||(a.interval=parseInt(r.v2C[s].d)),o.ctx&&o.ctx.poolReady?this.chainEffect(e,o,r.v2C[s],o.ctx.v2imgs["C"+s],l,{check:!0,interval:a.interval,full:g}):(o._uWorkDelayedRunEffect=o._uWorkDelayedRunEffect||[],o._uWorkDelayedRunEffect.push({idx:s,pts:l,opts:{check:!0,interval:a.interval,full:g}}))}else if("A"==d)if(p.tag&&p.local&&(p={x:p.get("x"),y:p.get("y"),w:p.get("w"),h:p.get("h"),cx:p.get("w")*p.get("origin").x,cy:p.get("h")*p.get("origin").y}),a.scene){var u=r["v2"+d][s],f=1/e.getZoomX(),v=1/e.getZoomY();if(p instanceof Array)for(var y=0;y<p.length;y++)p[y].x=(p[y].x-e.wgtX(t))*f,p[y].y=(p[y].y-e.wgtY(t))*v;else{void 0===p.w&&void 0===p.h&&(p.x=p.x-1,p.y=p.y-1,p.w=2,p.h=2,p.cx=1,p.cy=1);var f=1/e.getZoomX(),v=1/e.getZoomY();p.x=(p.x-e.wgtX(t))*f,p.y=(p.y-e.wgtY(t))*v,p.w=p.w*f,p.h=p.h*v,void 0===p.cx?p.cx=p.w/2:p.cx=p.cx*f,void 0===p.cy?p.cy=p.h/2:p.cy=p.cy*f}a.scene.call(o.ctx.apnx,o.ctx.v2imgs[d+s],p,{origin:x,count:u.c,duration:u.d},a.param)}else this._effect(e,o,d,s,p);else e.log(t,"Invalid parameter for Widget:run('effect',{...}).")}else e.log(t,"Invalid parameter for Widget:run('effect',{...}).")}},xa._effect=function(e,t,i,a,n){if(!t.ctx||!t.ctx.poolReady)return 0;var o=e.wgtGetProperty(t.apnOID,"cfg"),r=o["v2"+i][a];if(!r)return 0;if(!t.ctx.v2imgs[i+a])return 0;var p,d,s,c=1/e.getZoomX(),x=1/e.getZoomY(),l=e.screen.objects[t.apnOID].init;if("D"==i){var g;r.id&&e.screen.objects[r.id]&&(g=e.wgtGetProperty(r.id,"vertexInPage")),g&&g[0]&&g[1]&&(p=r.type,d=Math.min(r.c,200),s={param:{},x:(g[0].x-l.position.x)*c,y:(g[0].y-l.position.y)*x,radius:Math.sqrt(Math.pow(g[1].x-g[0].x,2)+Math.pow(g[1].y-g[0].y,2))*c,duration:Math.max(100,parseInt(r.d)),spread:(parseInt(r.s)||60)/180},s.param.radian=Math.atan2(-(g[1].x-g[0].x),g[0].y-g[1].y)-1.5*Math.PI)}else if("A"==i){var u,f;if(n)s={x:(n.x-l.position.x+n.w/2)*c,areaW:n.w*c,areaH:n.h*x},u=(n.y-l.position.y)*x,f=(n.y-l.position.y+n.h)*x;else if(r.id&&e.screen.objects[r.id]){var v=e.screen.objects[r.id].init;s={x:(v.position.x-l.position.x+v.shape.w/2)*c,areaW:v.shape.w*c,areaH:v.shape.h*x},u=(v.position.y-l.position.y)*x,f=(v.position.y-l.position.y+v.shape.h)*x}s&&(s.duration=Math.max(100,parseInt(r.d)),p=r.type,d=Math.min(r.c,200),"bubble"==p?s.y=f:"snow"!=p&&"snowL"!=p&&"snowR"!=p||(s.y=u,"snowL"==p&&(s.wind=-.3),"snowR"==p&&(s.wind=.3),p="fall"))}else if("C"==i&&r.id&&e.screen.objects[r.id]){var g=e.wgtGetProperty(r.id,"vertexInPage");g&&g.length&&this.chainEffect(e,t,r,t.ctx.v2imgs[i+a],g,{check:!0,interval:parseInt(r.d)})}return p?t.ctx.apnx[p](t.ctx.v2imgs[i+a],d,!1,s):0},xa.chainEffect=function(e,t,i,a,n,o){function r(){if(m<h){var n;i.c&&parseInt(i.c)?n=parseInt(i.c):(n=bx.HCL.DV.isMobile()?13:25,o&&o.full&&(n=Math.ceil(1.5*n))),void 0!==b&&b<10&&(n=Math.min(n,Math.ceil(250/h)));var s=void 0;"bubble"==i.type||"spiral"==i.type?s={}:"sprinkle"==i.type&&(s={param:{}},m<h-1&&(s.param.radian=Math.atan2(-(d[m+1].x-d[m].x),d[m].y-d[m+1].y)-1.5*Math.PI)),s.x=(d[m].x-e.screen.objects[t.apnOID].init.position.x)*(1/e.getZoomX()),s.y=(d[m].y-e.screen.objects[t.apnOID].init.position.y)*(1/e.getZoomY()),s.imgZoom=p,w=t.ctx.apnx[i.type](a,n,!0,s),void 0!==w&&(m++,e.setTimeout(r,void 0!==b?b:w/2))}}if(t.ctx&&t.ctx.poolReady&&i&&a){var p=1;i.imgR&&(p=parseInt(i.imgR)/100);var d=[];if(o&&o.check&&n.length>1){var s=Math.max(a.__maxImgW*p,a.__maxImgH*p);s*=2.5;var c,x,l=0;d.push(n[0]);for(var g=1;g<n.length;g++){if(x=Math.sqrt(Math.pow(n[g-1].x-n[g].x,2)+Math.pow(n[g-1].y-n[g].y,2)),c=Math.floor(x/s))for(var u,f,v,y=0;y<c;y++)u=(Math.atan2(n[g].x-n[g-1].x,n[g-1].y-n[g].y)+2*Math.PI)%(2*Math.PI),f=Math.sin(u)*s*(y+1),v=-Math.cos(u)*s*(y+1),d.push({x:n[g-1].x+f,y:n[g-1].y+v});l+=x-s*c,g<n.length-1&&l>s&&(l=0,d.push(n[g]))}d.push(n[n.length-1])}else 1==n.length&&d.push(n[0]);var h=d.length,m=0,w=0,b=void 0;o&&void 0!==o.interval&&(b=bx.$checkNaN(parseInt(o.interval)),b*=1/e.getZoomX());r()}},xa.pubOnGetPrerequisite=function(e,t,i){return[{url:"wgts/apnx-ani-1.0.js",type:"text/javascript"}]},xa.createAsCanvasObject=function(e,t,i,a,n){return apn.IWidget.createCanvasObject(e,this,"apn.CNoneClipLayerContainer",bx.CCanvasWnd.SHAPE_RECT,t,i,a,n)},xa.WGTS_SHOW=["apn.wgt.rect","apn.wgt.line","apn.wgt.ellipse","apn.wgt.polygon","apn.wgt.polyline","apn.wgt.polycurve"],xa.onEdit=function(e,t,i,a,n){var o=e.getObjectByID(t);apn.widgets.utils.editWidget(o,e,2,!1,{wgtsShow:this.WGTS_SHOW,wgtsShowOverride:!0},n)},xa.edtOnPostDraw=function(e,t,i,a,n,o,r,p){if(p){for(var d,s,c=e.getObjectByID(t),x=e.wgtGetProperty(t,"cfg"),l=e.getData().pages[e.getPageID()].objects,g=[],u=[],f={},v=0;v<x.v2D.length;v++)d=x.v2D[v],d.id&&l[d.id]&&(s=l[d.id].init)&&s.shape.type==bx.CCanvasWnd.SHAPE_LINE&&(f["D"+d.id]=f["D"+d.id]||0,g.push({x:a+(s.position.x-c.position.x)+s.shape.x[0]+f["D"+d.id],y:n+(s.position.y-c.position.y)+s.shape.y[0]}),f["D"+d.id]+=32,u.push("D"+(v+1)));for(v=0;v<x.v2A.length;v++)if(d=x.v2A[v],d.id&&l[d.id]&&(s=l[d.id].init)){var y={x:a+(s.position.x-c.position.x)+s.shape.w/2};"bubble"==d.type?y.y=n+(s.position.y-c.position.y)+s.shape.h:y.y=n+(s.position.y-c.position.y),g.push(y),u.push("A"+(v+1))}for(v=0;v<x.v2C.length;v++)d=x.v2C[v],d.id&&l[d.id]&&(s=l[d.id].init)&&(g.push({x:a+(s.position.x-c.position.x)+s.shape.w/2,y:n+(s.position.y-c.position.y)+s.shape.h/2}),u.push("C"+(v+1)));apn.CEditorS.utilDrawMarks(i,g,u)}},xa.edtOnConfig=function(e,t){function i(){eduLib.edtInputApplyAll(e,a),e.wgtSetProperty(t,"cfg",n),e.wgtRefreshUI(t)}var a,n=e.wgtGetProperty(t,"cfg"),o=e.getScreenData(),r=[];for(var p in o.objects)apn.Project.findParentOf(o,p,void 0,!0,!0)==t&&o.objects[p].create.data&&"apn.wgt.line"==o.objects[p].create.data.wgtID&&r.push({value:p,title:e.itrGetObjectTitle(p)});eduLib.utilSortObjectsByTitle(e,r),r.push({value:"",title:apn.CExe.GL(apn.CExe.TXT_SETUP_NOSEL)});var d=[];for(var p in o.objects)apn.Project.findParentOf(o,p,void 0,!0,!0)==t&&o.objects[p].create.data&&"apn.wgt.rect"==o.objects[p].create.data.wgtID&&d.push({value:p,title:e.itrGetObjectTitle(p)});eduLib.utilSortObjectsByTitle(e,d),d.push({value:"",title:apn.CExe.GL(apn.CExe.TXT_SETUP_NOSEL)});var s,c=[];for(var p in o.objects)s=apn.Project.getWidgetModule(o.objects[p].create.data),p!=t&&s&&s.exePropGet&&s.exePropGet(this,p,"vertexInPage",!0)&&c.push({value:p,title:e.itrGetObjectTitle(p)});eduLib.utilSortObjectsByTitle(e,c),c.push({value:"",title:apn.CExe.GL(apn.CExe.TXT_SETUP_NOSEL)});var x={title:apn.CExe.GL({ko:"불꽃놀이/뿌리기",en:"Sprinkle/Firework"}),value:"sprinkle"},l={title:apn.CExe.GL({ko:"풍선/거품",en:"Bubble/Balloon"}),value:"bubble"},g={title:apn.CExe.GL({ko:"눈/꽃",en:"Snow/Flower"}),value:"snow"},u={title:apn.CExe.GL({ko:"눈/꽃 왼족",en:"Snow/Flower to left"}),value:"snowL"},f={title:apn.CExe.GL({ko:"눈/꽃 오른쪽",en:"Snow/Flower to right"}),value:"snowR"},v={title:apn.CExe.GL({ko:"회오리",en:"Spiral"}),value:"spiral"},y=apn.CExe.GL({ko:"효과",en:"Effect"})+" (m)",h=apn.CExe.GL({ko:"조각 개수",en:"Particle count"}),m=apn.CExe.GL({ko:"시간",en:"Duration"})+"[ms]",w=apn.CExe.GL({ko:"이미지 ",en:"Image "}),b={type:"number",key:"d",min:100,width:"120px"},I={type:"number",key:"c",min:1,max:100,width:"80px"},D={type:"image",key:"i1"},C={type:"image",key:"i2"},k={type:"image",key:"i3"},E={type:"image",key:"i4"},L={type:"image",key:"i5"};if(a=e.dlgDoModal(Math.ceil(.8*bx.UX.width),Math.ceil(.8*bx.UX.height),i)){a.style.padding="12px",a.style.boxSizing="border-box";var _={type:"title",title:apn.CExe.GL({ko:"영역 효과",en:"Areal effect"})};apn.CExe.edtSetupAddHelp(_,"edu.wgt.ptclScene"),eduLib.edtInputAdd(e,a,_),eduLib.edtInputAdd(e,a,{type:"table",value:n.v2A,options:{th:[y,apn.CExe.GL({ko:"영역 위젯",en:"Area widget"})+" (m)",h,m,w+"1 (m)",w+" 2",w+" 3",w+" 4",w+" 5"],add:!0,remove:!0,order:!0,orderPrefix:"A"},td:[{type:"select",key:"type",options:[g,u,f,l],width:"150px"},{type:"select",key:"id",options:d,width:"190px"},I,b,D,C,k,E,L],join:!0}),eduLib.edtInputAdd(e,a,{type:"space"}),_={type:"title",title:apn.CExe.GL({ko:"지향성 효과",en:"Directional effect"})},apn.CExe.edtSetupAddHelp(_,"edu.wgt.ptclScene"),eduLib.edtInputAdd(e,a,_),eduLib.edtInputAdd(e,a,{type:"table",value:n.v2D,options:{th:[y,apn.CExe.GL({ko:"방향 위젯",en:"Direction widget"})+" (m)",h,m,apn.CExe.GL({ko:"퍼지는 각도",en:"Spread angle"})+"[°]",w+"1 (m)",w+" 2",w+" 3",w+" 4",w+" 5"],add:!0,remove:!0,order:!0,orderPrefix:"D"},td:[{type:"select",key:"type",options:[x],width:"150px"},{type:"select",key:"id",options:r,width:"190px"},I,b,{type:"number",key:"s",min:1,max:360,width:"100px"},D,C,k,E,L],join:!0}),eduLib.edtInputAdd(e,a,{type:"space"}),_={type:"title",title:apn.CExe.GL({ko:"연속 효과",en:"Chained effect"})},apn.CExe.edtSetupAddHelp(_,"edu.wgt.ptclScene"),eduLib.edtInputAdd(e,a,_),eduLib.edtInputAdd(e,a,{type:"table",value:n.v2C,options:{th:[y,apn.CExe.GL({ko:"도형 위젯",en:"Shape widget"})+" (m)",h,apn.CExe.GL({ko:"간격 시간",en:"Interval time"})+"[ms]",apn.CExe.GL({ko:"이미지 확대/축소",en:"Image resize"})+"[%]",w+"1 (m)",w+" 2",w+" 3",w+" 4",w+" 5"],add:!0,remove:!0,order:!0,orderPrefix:"C"},td:[{type:"select",key:"type",options:[l,x,v],width:"150px"},{type:"select",key:"id",options:c,width:"190px"},{type:"number",key:"c",min:1,max:25,width:"80px"},b,{type:"number",key:"imgR",min:1,max:200,width:"140px"},D,C,k,E,L],join:!0})}},xa.edtOnBuildState=function(e,t,i,a){var n,o=e.pages[i].objects[t].create.data.properties.attrs.cfg;a.ready="Ready";var r={A:!0,C:!0,D:!0};for(var p in r)for(var d=0;d<o["v2"+p].length;d++)n=o["v2"+p][d],n.id&&e.pages[i].objects[n.id]&&(n.i1.mediaID||n.i2.mediaID||n.i3.mediaID||n.i4.mediaID||n.i5.mediaID)&&(a[p+"_"+d]="Effect "+p+(d+1))},xa.edtOnCheckEdited=function(e,t){var i,a=e.wgtGetProperty(t,"cfg"),n={A:!0,C:!0,D:!0};for(var o in n)for(var r=0;r<a["v2"+o].length;r++)if(i=a["v2"+o][r],i.id&&e.getObjectByID(i.id))return!0;return!1},xa.edtOnRemapObjectID=function(e,t,i){var a,n={A:!0,C:!0,D:!0},o=t.properties.attrs.cfg;for(var r in n)for(var p=0;p<o["v2"+r].length;p++)a=o["v2"+r][p],a.id&&(i[a.id]?a.id=i[a.id]:e.getScreenData().objects[a.id]||(a.id=""))},uxWgtPtclScene=xa;
var xa=apn.inheritWidget(apn.widgets["apn.wgt.layerContainer"]);xa.editor=xa.editor||{},xa.editor.iconThumb="DB/EDU/imgs/wgts/thumbs/spriteAnimation.png",xa.editor.states={play:"Play",loop:"Loop",stop:"Stop"},xa.scriptInfo=void 0,xa.properties.state="stop",xa.properties.attrs={apxAnimate:!0,cfg:{idStep:""}},xa.createAsCanvasObject=function(t,e,a,i,r){return apn.IWidget.createCanvasObject(t,apn.widgets["apn.wgt.layerContainer"],"apn.CLayerContainer",bx.CCanvasWnd.SHAPE_RECT,e,a,i,r,{orderedActive:!0})},xa.exeFireStateEvent=void 0,xa.exeSetState=function(t,e,a){a&&("play"==a||"loop"==a?t.wgtAniCheck(t.wgtId(e))>1&&t.wgtAniRun(t.wgtId(e),"play"==a?1:2)&&t.fireEvent("animation","Start",e.apnOID):"stop"==a&&t.wgtAniSet(t.wgtId(e)))},xa.exeOnLoad=function(t,e){function a(a,r){if(a==i.idStep&&r){var n=apn.Project.getStateByObjectID(t.viewer.project,t.getPageID(),e);n&&(apn.UTIL.sort(n,"order",1,!0),n[r.current]&&n[r.current].stateID&&t.wgtSetProperty(e,"apxLayer",n[r.current].stateID))}}var i=t.wgtGetProperty(e,"cfg");i&&i.idStep&&t.wgtTag(i.idStep)&&t.wgtListenProperty(e,"apxStep",a)},xa.edtSetupStep=function(t,e,a,i){var r=t.getScreenData(),n=[{title:apn.CExe.GL({ko:"[없음]",en:"[None]",ja:"[なし]"}),value:""}];for(var o in r.objects)r.objects[o].create&&r.objects[o].create.data&&r.objects[o].create.data.properties&&r.objects[o].create.data.properties.attrs&&r.objects[o].create.data.properties.attrs.apxStep&&n.push({value:o,title:t.itrGetObjectTitle(o)});eduLib.edtInputAdd(t,a,{type:"select",options:n,title:apn.CExe.GL({ko:"연동할 위젯",en:"Widget to interface with",ja:"連動するウィジェット"}),key:"idStep",value:i,join:!0})},xa.edtOnConfig=function(t,e){function a(){eduLib.edtInputApplyAll(t,i),t.wgtSetProperty(e,"cfg",r)}var i,r=t.wgtGetProperty(e,"cfg")||{idStep:""};if(i=t.dlgDoModal(600,200,a)){var n=apn.CExe.CSS_SETUP_PANE+"height:"+(i.clientHeight-40)+"px";i.tagTab=i.$TAG("div",{style:"position:relative;font-weight:bold;width:100%;height:26px;padding-bottom:14px;"}),i.tagTab.innerHTML='<span id="tagTab2" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"스텝 연동",en:"Step Interface",ja:"ステップ連動"})+"</span>"+apn.CExe.CSS_SETUP_TAB_END,i.tagTab2=i.$TAG("div",{style:n}),this.edtSetupStep(t,e,i.tagTab2,r),i.tagTab.$$("tagTab2").style.borderStyle="solid solid none solid",i.tagTab.$$("tagBlank").style.width=i.clientWidth-i.tagTab.$$("tagBlank").offsetLeft-1+"px"}},xa.WGTS_SHOW=["edu.wgt.animSprite","apn.wgt.rect","apn.wgt.singleText","apn.wgt.roundRect","apn.wgt.ellipse","apn.wgt.line","apn.wgt.image2","apn.wgt.polygon","apn.wgt.video","apn.wgt.itrAreaRect","apn.wgt.itrAreaEllipse","ux.wgt.imgSprite","ux.wgt.shtSprite"],xa.onEdit=function(t,e){apn.widgets.utils.editWidget(t.getObjectByID(e),t,2,!0,{wgtsShow:this.WGTS_SHOW,layerTitleFromOrder:!0,layerDuration:apx.wgt.spriteDefaultFrameDuration,layerOrdering:!0,layerScrollbar:"always"})},eduWgtAnimSprite=xa,xa=apn.inheritWidget(apn.widgets["apn.wgt.sceneContainer"]),xa.exeItrNoResize=!0,xa.editor=xa.editor||{},xa.editor.iconThumb="DB/EDU/imgs/wgts/thumbs/sceneAnimation.png",xa.editor.states={play:"Play",loop:"Loop",stop:"Stop",stopL:"StopAtLast"},xa.properties.state="stop",xa.properties.attrs={apxAnimate:!0,ver:2,ofl:""},xa.exeSetState=function(t,e,a,i){function r(t,e){return void 0===t.order&&void 0===e.order?0:void 0===t.order?1:void 0===e.order?-1:t.order-e.order}if(a)if(i||"stopL"!=a||(a="stop"),"stopL"==a){var n=apn.Project.getStateByObjectID(t.project,t.getPageID(),e.apnOID);n&&n.length>0&&(n.sort(r),t.wgtAniSet(t.wgtId(e),void 0,n[n.length-1].title))}else eduWgtAnimSprite.exeSetState.call(this,t,e,a)},xa.exeOnLoad=eduWgtAnimSprite.exeOnLoad,xa.onEdit=function(t,e){apn.widgets.utils.editWidget(t.getObjectByID(e),t,1,!0,{layerTitleFromOrder:!0,layerDuration:apx.wgt.spriteDefaultFrameDuration,layerOrdering:!0,layerScrollbar:"always",wgtsShow:apn.widgets["apn.wgt.sceneContainer"].WGTS_SHOW,editNoGroup:!0})},eduWgtAnimScene=xa,xa=apn.inheritWidget(apn.widgets["apn.wgt.layerContainer"]),xa.editor=xa.editor||{},xa.editor.iconThumb="DB/EDU/imgs/wgts/common/icon_thumb.png",xa.properties.attrs={apxAnimateHolder:!0},xa.exeSetState=void 0,xa.onEdit=function(t,e){apn.widgets.utils.editWidget(t.getObjectByID(e),t,2,!0,{layerTitlePrefix:"State",layerScrollbar:"always"})},eduWgtAnimHolder=xa,xa=apn.inheritWidget(eduWgtAnimHolder),xa.editor=xa.editor||{},xa.editor.iconThumb="DB/EDU/imgs/wgts/thumbs/sceneAnimation.png",xa.properties.attrs={apxAnimateHolder:!0},xa.exeSetState=function(t,e,a,r){var n,o,p=t.screen.objects[e.apnOID].layout.layers;for(i in p)for(n=t.getWidgetsByProperty("apxAnimate",p[i].id),o=0;o<n.length;o++)i!=a?t.wgtSetProperty(n[o],"apxState","stop"):t.wgtSetProperty(n[o],"apxState","loop");a!=r&&t.fireEvent("stateChange",a,e.apnOID)},xa.exeOnStart=function(t,e){var a=this;setTimeout(function(){a.exeSetState(t,t.wgtTag(e),t.stateGetActive(e))},0)},eduWgtAnimHolder2=xa;
var xa=apn.inheritWidget(apn.widgets["apn.wgt.roundRect"]);xa.apdConfigReadOnly=!0,xa.apxTextPlainMulti=!0,xa.apxTextAlignJustify=!0,xa.editor=xa.editor||{},xa.editor.iconThumb="DB/EDU/imgs/wgts/thumbs/subtitle.png",xa.styles=xa.styles||{},xa.styles.textMultiLine=!0,xa.styles.lineWidth=0,xa.properties=xa.properties||{},xa.properties.attrs={apxMediaSubtitle:!0,v:"2",vJ:!0,vBR:!0,subs:[{track:1,stime:"00:00:00",etime:"00:01:99",text:"",pOes:"N"}],cfg:{colorFocus:"#ff0000",vtt:{size:0,data:""},mode:"",modeClr:null,ptpClr:null,ptpVolFade:0,txt:"",idMedia:"",idTarget:"",yMrg:"1",bgP:""}},xa.properties.state="r",xa.scriptInfo={wgtData:{error:{help:{ko:"String\nVTT 파일 분석 오류",en:"String\nVTT File paring error",ja:"String\nVTTファイル解析エラー"},value:"",type:"go"},subtitle:{help:{ko:"String\n자막파일 지정. WebVTT만 지원합니다. ('value'값에 의해서도 데이터 지정이 가능합니다.)",en:"String\nSet subtitle file. 'WebVTT' format is supported. (Also, this information can be set by 'value'.)",ja:"String\n字幕ファイルを指定。WebVTTのみサポートします。（ 'value'の値によってもデータの指定が可能です。）"},value:"",type:"so"}},wgtRun:{play:{param:"{index:0-based|'next'|'prev'|'clear'|'reset', playSection:Boolean}",help:{en:"Play the media section by subtitle information",ko:"자막 구간을 Play합니다.\n'index'에 자막의 번호, 'next' 및 'prev'로 구간을 지정할 수 있습니다.\n'playSection'이 true이면 해당 구간으로 영역이 제한됩니다.\n'index'에서 'clear'값은 지정된 Section을 해제하는 기능입니다.",ja:"字幕区間をPlayします。\n'index'に字幕の番号、「next」と「prev」に区間を指定することができます。\n'playSection'がtrueの場合は、該当区間の領域が制限されます。\n'index'から「clear」の値は、指定されたSectionを解除する機能です。"}}}},xa.exeGetSizeByContent=apn.widgets["apn.wgt.roundRect"].exeGetSizeByContent,xa.createAsCanvasObject=function(t,e,a,i,n){return n&&n.attrs&&"2a"==n.attrs.v?(n.attrs.URL="DB/EDU/imgs/wgts/edit/mediaAnnt.png",apn.IWidget.createCanvasObject(t,this,"apn.CImage",bx.CCanvasWnd.SHAPE_RECT,e,a,i,n,void 0,apn.CEditorS.NO_RESIZE)):apn.widgets["apn.wgt.roundRect"].createAsCanvasObject.call(this,t,e,a,i,n)},xa.exeOnScreenRefresh=function(t,e,a){var i=t.wgtGetProperty(e,"cfg");if(i.ptp&&"N"!=i.ptp){var n=t.wgtTag(e);if(2==n.apnCur._apnWgtRectTV)return;var r,o=!0;if(a&&a.font&&a.font!=t.wgtGetProperty(e,"apxFont",!0)&&(o=!1),o&&(r=t.wgtGetProperty(e,"apxText"))&&n.textTag){var d=!1;if(!bx.DOM.isVisible(n)){var l,s;d=!0,l=n.style.display,n.style.display="block",n.style.visibility="hidden",s=n.parentNode,document.body.appendChild(n)}var p=n.clientWidth-2*bx.$checkNaN(parseInt(n.style.padding)),c=n.clientHeight-2*bx.$checkNaN(parseInt(n.style.padding));n.textTag.scrollWidth&&n.textTag.scrollWidth>p||n.textTag.scrollHeight&&n.textTag.scrollHeight>c?(void 0===n._apxTextBkPadding&&(n._apxTextBkPadding=n.style.padding),n.style.padding=Math.max(0,Math.floor(bx.$checkNaN(parseInt(n.style.padding))-Math.max(n.textTag.scrollWidth-p,n.textTag.scrollHeight-c)/2))+"px"):void 0!==n._apxTextBkPadding&&(n.style.padding=n._apxTextBkPadding),d&&(n.style.visibility="visible",n.style.display=l,s.appendChild(n))}}else apn.widgets["apn.wgt.roundRect"].exeOnScreenRefresh.call(this,t,e,a)},xa.exePropGet=function(t,e,a,i){if("error"==a){if(i)return!0;var n=t.wgtTag(e);if(n.ctx)return n.ctx._lastErr||""}},xa.exePropSet=function(t,e,a,i,n){if("pauseOnTrack"==a){if(n)return!0;var r=t.wgtTag(e);r.ctx&&(r.ctx.__disablePauseOnTrack=!i)}else if("strictCanPlayCheck"==a){if(n)return!0;var r=t.wgtTag(e);r.ctx&&(r.ctx.__strictCanPlayCheck=!!i)}},xa.exeOnLoad=function(t,e){function a(a,i,n){var r;"trackStart"==a?d.ctx.curTrack=n:"infoPlayTime"==a?(r=p._findkSub(t,e,i),r==d.ctx.curSub?r=void 0:d.ctx.curSub=r):"trackEnd"==a&&(r=-1,d.ctx.curSub=r),r==-1?t.wgtSetProperty(e,"apxText",""):r>=0&&t.wgtSetProperty(e,"apxText","[[HTML]]"+(l[r].text||"").replace(/\[\[/g,'<span style="font-family:inherit;color:'+s.colorFocus+';">').replace(/\]\]/g,"</span>"))}function i(a,i){if(a==e&&i&&void 0!==i.index&&d.ctx.times.length){if(d.ctx.__strictCanPlayCheck&&!d.ctx._canPlay)return d.ctx._canPlayDelayed=d.ctx._canPlayDelayed||[],void d.ctx._canPlayDelayed.push(i);if(d.ctx.curSection=void 0,"clear"==i.index||"reset"==i.index)return void(d.ctx&&d.ctx.idMedia&&(t.wgtSetProperty(d.ctx.idMedia,"playSection",void 0),"reset"==i.index&&(d.ctx.curSub=-1)));if("next"==i.index?void 0===d.ctx.curSub?i.index=0:i.index=(d.ctx.curSub+1)%d.ctx.times.length:"prev"==i.index&&(void 0===d.ctx.curSub?i.index=0:i.index=(d.ctx.curSub-1+d.ctx.times.length)%d.ctx.times.length),d.ctx&&d.ctx.idMedia&&d.ctx.times[i.index]&&void 0!==d.ctx.times[i.index].stime){var n=apn.Project.getWidgetModule(t.screen.objects[d.ctx.idMedia].create.data);if(n&&n.exeMediaSeek){if(i.playSection){var r={from:d.ctx.times[i.index].stime,to:d.ctx.times[i.index].etime,clearOnEnd:i.clearOnEnd,fadeInOut:s.ptpVolFade||0};t.wgtSetProperty(d.ctx.idMedia,"playSection",r),d.ctx.curSection=r}n.exeMediaSeek(t.wgtTag(d.ctx.idMedia),d.ctx.times[i.index].stime,!0)}}}}function n(t,a){t==e&&a&&void 0!==a.index&&l[a.index]&&(a.pauseOnStart===!0?l[a.index].pOes="Y":a.pauseOnStart===!1&&(l[a.index].pOes="N"))}function r(e,a,i){if("seeked"==e)d.ctx._seeked=!0;else if("canPlay"==e&&d.ctx.__strictCanPlayCheck&&(d.ctx._canPlay=!0,d.ctx._canPlayDelayed)){for(var n=0;n<d.ctx._canPlayDelayed.length;n++)t.wgtSetProperty(d.apnOID,"play",d.ctx._canPlayDelayed[n]);delete d.ctx._canPlayDelayed}}function o(a,i){if(a==e&&i){var n=[],r={message:""};if(p._vttParse(i,n,r,t.wgtGetProperty(e,"vBR"))){for(var o=0;o<n.length;o++)n[o].stime=p._timeToSec(n[o].stime),n[o].etime=p._timeToSec(n[o].etime);p.exeInputSet(t,d,n),t.wgtSetProperty(e,"apxSubtitle",n)}r.message&&t.log(e,"WebVTT format error: "+r.message+"\r\n"+i),d.ctx._lastErr=r.message||""}}var d=t.wgtTag(e),l=t.wgtGetProperty(e,"subs"),s=t.wgtGetProperty(e,"cfg"),p=this;if("2a"==t.wgtGetProperty(e,"v")&&(d.style.display="none"),t.wgtGetProperty(e,"v"))d.ctx={},s.idMedia&&t.wgtTag(s.idMedia)&&(d.ctx.idMedia=s.idMedia);else{var c=t.getWidgetsByProperty("apxMediaControl"),u=t.getWidgetsByProperty("apxMediaControl");if(!c.length)return t.log(e,"No media widget is in this page."),!1;for(var x=apn.Project.findParentOf(t.screen,e,void 0,!0),g=0;g<u.length;g++)x&&x!=apn.Project.findParentOf(t.screen,u[g],void 0,!0)&&(u.splice(g,1),g--);d.ctx={},d.ctx.idMedia=this._closest(t,e,u)||this._closest(t,e,c)}if(d.ctx.curSub=-1,d.ctx.curTrack=1,d.ctx.curSection=void 0,t.wgtGetProperty(e,"v")){if(d.ctx.curSub=void 0,d.ctx.idMedia){var y=apn.Project.getLayout(t.project).property.CExe;if(y&&"Y"==y.vdStrictPlay){var b=t.wgtTag(d.ctx.idMedia).mediaTag;"video"==b.tagName.toLowerCase()&&(d.ctx.__strictCanPlayCheck=!0)}}t.wgtListenProperty(e,"play",i),t.wgtListenProperty(e,"track",n),d.ctx.idMedia&&t.wgtListenMedia(e,d.ctx.idMedia,r)}else t.wgtListenMedia(e,d.ctx.idMedia,a);t.wgtGetProperty(e,"cfg").mode?this._setupSpaned(t,e,s,l):t.wgtSetProperty(e,"apxText",""),d.ctx.times=[];for(var g=0;g<l.length;g++)d.ctx.times.push({track:l[g].track,stime:this._timeToSec(l[g].stime),etime:this._timeToSec(l[g].etime),text:l[g].text});t.wgtListenProperty(e,"subtitle",o,!0)},xa.exeSetState=function(t,e,a,i){function n(t){for(var e=0;e<l.length;e++)if(l[e].text==t)return e;return-1}var r,o,d=t.wgtGetProperty(e.apnOID,"v"),l=t.wgtGetProperty(e.apnOID,"subs");"p"==a[0]&&(o={index:"clear"}),"pNxt"==a?r={index:"next"}:"pPrv"==a?r={index:"prev"}:0==a.indexOf("p_")?"2a"==d?n(a.substring(2))>=0&&(r={index:n(a.substring(2))}):r={index:parseInt(a.substring(2))-1}:0==a.indexOf("part_")?"2a"==d&&n(a.substring(5))>=0&&(r={index:n(a.substring(5)),playSection:!0,clearOnEnd:!0}):"sNxt"==a?r={index:"next",playSection:!0}:"sPrv"==a?r={index:"prev",playSection:!0}:0==a.indexOf("s_")?"2a"==d?n(a.substring(2))>=0&&(r={index:n(a.substring(2)),playSection:!0}):r={index:parseInt(a.substring(2))-1,playSection:!0}:"sC"==a&&(r={index:"clear"}),r&&o&&t.wgtSetProperty(e.apnOID,"play",o),r&&t.wgtSetProperty(e.apnOID,"play",r)},xa.exePropSet=function(t,e,a,i,n){function r(e,a,i){if("seeked"==e)o.ctx._seeked=!0;else if("canPlay"==e&&o.ctx.__strictCanPlayCheck&&(o.ctx._canPlay=!0,o.ctx._canPlayDelayed)){for(var n=0;n<o.ctx._canPlayDelayed.length;n++)t.wgtSetProperty(o.apnOID,"play",o.ctx._canPlayDelayed[n]);delete o.ctx._canPlayDelayed}}if("media"==a){if(n)return!0;if(i&&t.wgtTag(i)){var o=t.wgtTag(e);o.ctx.idMedia&&t.wgtListenMediaCancel(e,o.ctx.idMedia),o.ctx.idMedia=i;var d=apn.Project.getLayout(t.project).property.CExe;if(d&&"Y"==d.vdStrictPlay){var l=t.wgtTag(o.ctx.idMedia).mediaTag;"video"==l.tagName.toLowerCase()&&(o.ctx.__strictCanPlayCheck=!0)}t.wgtListenMedia(e,o.ctx.idMedia,r)}}},xa._setupSpaned=function(t,e,a,i){var n=t.wgtTag(e),r=this._buildText(t,e),o="[[HTML]]"+r.replace(/\[\[/g,'<span style="font-family:inherit;color:'+a.colorFocus+';">').replace(/\]\]/g,"</span>");if(t.wgtGetProperty(e,"apxText")!=o&&t.wgtSetProperty(e,"apxText",o),a.ptp&&"N"!=a.ptp)for(var d,l=0;l<i.length;l++)(d=n.$$(l+"C"))&&(n.$$(l+"S")&&(n.$$(l+"S").style.cursor="apn.auto"==apn.Project.resolveStyle(t.project,"csr",t.wgtGetProperty(e,"apxCursor"))?"pointer":"inherit"),d.apxOnEventOver=function(t,e){e?(a.ptpClr&&(this.style.backgroundColor=a.ptpClr),"Y"==a.ptpBold&&(this.style.fontWeight="bold")):(a.ptpClr&&(this.style.backgroundColor="transparent"),"Y"==a.ptpBold&&(this.style.fontWeight="inherit"))},d.apxOnEvent=function(t,i){"tapStart"==i&&t.wgtSetProperty(e,"play",{index:parseInt(this.id),playSection:"R"==a.ptp})})},xa.exeOnStart=function(t,e){var a=t.wgtGetProperty(e,"cfg");if(a.idTarget&&t.wgtTag(a.idTarget)&&("Y"==a.syncStateN||(t.wgtTag(a.idTarget).style.display="none")),this.apxTextPlainMulti){var i=t.wgtTag(e),n=this;i.apnOnPostSetText=function(i,r){var o=n._buildTextPlain(t,e);t.wgtSetProperty(e,"apxTextPlainMulti",{txt:o,lnToTag:!0}),a.mode&&n._setupSpaned(t,e,a,t.wgtGetProperty(e,"subs"))};var r=this._buildTextPlain(t,e);r&&i.apnOnPostSetText(i,r)}},xa.exeOnTick=function(t,e,a){function i(e){var a=apn.Project.getStateByObjectID(t.project,t.getPageID(),o.idTarget);if(a)for(var i=0;i<a.length;i++)if(a[i].title==e){t.stateLayerActivate(o.idTarget,a[i].stateID),t.stateSetActive(o.idTarget,a[i].stateID);break}}function n(a){var n=t.wgtGetProperty(e,"subs");if(a==r.ctx.curSub?a=void 0:r.ctx.curSub=a,"disd"!=t.wgtGetProperty(e,"apxState"))if("2a"==t.wgtGetProperty(e,"v"))a==-1||a>=0&&!n[a].text?(o.idTarget&&t.wgtTag(o.idTarget)&&("Y"==o.syncStateN?(t.wgtTag(o.idTarget).style.display="block",i("[None]")):t.wgtTag(o.idTarget).style.display="none"),t.fireEvent("wgtEvent","[None]",e,d,!0)):a>=0&&n[a].text&&(o.idTarget&&t.wgtTag(o.idTarget)&&(t.wgtTag(o.idTarget).style.display="block",i(n[a].text)),t.fireEvent("wgtEvent",encodeURIComponent(n[a].text||""),e,d,!0),"Y"==n[a].pOes&&(r.ctx.__disablePauseOnTrack||r.ctx.idMedia&&t.wgtControlMedia(r.ctx.idMedia,"pause")));else{if(o.mode){var s;if(void 0!==a)for(var p=0;p<n.length;p++)(s=r.$$(p+"S"))&&(p==a?"s1"==o.mode?(o.modeClr&&(s.style.color=o.modeClr),"Y"==o.modeBold&&(s.style.fontWeight="bold")):o.modeClr&&(s.style.backgroundColor=o.modeClr):"s1"==o.mode?(s.style.color="inherit",s.style.fontWeight="inherit"):s.style.backgroundColor="transparent")}else a==-1?t.wgtSetProperty(e,"apxText",""):a>=0&&t.wgtSetProperty(e,"apxText","[[HTML]]"+l._convertLN(t,e,(n[a].text||"").replace(/\[\[/g,'<span style="font-family:inherit;color:'+o.colorFocus+';">').replace(/\]\]/g,"</span>")));a==-1?t.fireEvent("wgtEvent","[None]",e,d,!0):a>=0&&t.fireEvent("wgtEvent",a+1+"",e,d,!0)}}var r=t.wgtTag(e),o=t.wgtGetProperty(e,"cfg"),d="Y"==t.wgtGetProperty(e,"apxBackgroundTick"),l=this;if(r.ctx&&r.ctx.idMedia){if("2a"==t.wgtGetProperty(e,"v")&&r.ctx._seeked&&r.ctx.curSub!=-1)if("Y"==o.v2aRS)n(-1),r.ctx._curTime=void 0,r.ctx.curSection=void 0;else if(r.ctx.curSection){var s=t.wgtGetMediaInfo(r.ctx.idMedia,"currentTime");s>=r.ctx.curSection.from&&s<r.ctx.curSection.to||(r.ctx._curTime=void 0,r.ctx.curSection=void 0)}if(void 0===r.ctx._curTime&&(r.ctx._curTime=0),(!t.wgtGetMediaInfo(r.ctx.idMedia,"pause")&&!t.wgtGetMediaInfo(r.ctx.idMedia,"seeking")||r.ctx._seeked)&&t.wgtGetMediaInfo(r.ctx.idMedia,"currentTime")){r.ctx._end=!1;var s=t.wgtGetMediaInfo(r.ctx.idMedia,"currentTime");(!r.ctx.curSection||s>=r.ctx.curSection.from&&s<r.ctx.curSection.to)&&(!bx.HCL.DV.isIOS()||s>r.ctx._curTime||s<r.ctx._curTime-.2)&&(n(this._findkSub(t,e,s)),r.ctx._curTime=s)}else t.wgtGetMediaInfo(r.ctx.idMedia,"end")&&!r.ctx._end?(r.ctx._end=!0,n(-1),r.ctx._curTime=0):r.ctx._refresh&&(r.ctx._refresh=!1,n(-1),r.ctx._curTime=0);r.ctx._seeked=!1}},xa.exeInputGet=function(t,e){if(e.ctx&&e.ctx.times)return bx.$cloneObject([],e.ctx.times)},xa.exeInputSet=function(t,e,a){if(e.ctx&&e.ctx.times&&a){e.ctx.times.length=0;for(var i=0;i<a.length;i++)e.ctx.times.push(a[i]);this._refresh(t,e.apnOID)}},xa._refresh=function(t,e){var a=t.wgtTag(e),i=t.wgtGetProperty(e,"subs"),n=t.wgtGetProperty(e,"cfg"),r=t.wgtGetProperty(e,"v");if(a.ctx._refresh=!0,r&&"2"==r[0]){n.mode&&(n.txt="");for(var o,d=0;d<a.ctx.times.length;d++)i[d]=i[d]||{track:1,pOes:a.ctx.times[d].pOes||"N"},i[d].text=a.ctx.times[d].text,i[d].txtPos=n.txt.length,n.mode&&(o=!1,d==a.ctx.times.length-1&&(o=!0),a.ctx.times[d].text.length&&"\n"==a.ctx.times[d].text[a.ctx.times[d].text.length-1]&&(o=!0),n.txt+=a.ctx.times[d].text+(o?"":" "));i.length=a.ctx.times.length,n.mode&&this._setupSpaned(t,e,n,i)}},xa._convertLN=function(t,e,a){var i=t.wgtGetProperty(e,"cfg"),n="";if(i&&"2"==i.yMrg)for(var r=0;r<a.length;r++)n+=0!=r&&"\n"==a[r-1]||"\n"!=a[r]?r>0&&"\n"==a[r-1]&&"\n"==a[r]?'<div style="cursor:inherit;line-height:1em;">&nbsp;</div>':a[r]:"<br/>";else if(i&&"1"==i.yMrg)for(var r=0;r<a.length;r++)n+="\n"==a[r]?"<br/>":a[r];else for(var r=0;r<a.length;r++)n+="\n"==a[r]&&"\n"!=a[r+1]?"<br/>":"\n"==a[r]&&"\n"==a[r+1]?'<div style="cursor:inherit;line-height:1em;">&nbsp;</div>':a[r];return n},xa._findkSub=function(t,e,a){var i=t.wgtTag(e);t.wgtGetProperty(e,"subs");if(i.ctx&&i.ctx.idMedia&&t.wgtGetMediaInfo(i.ctx.idMedia,"end"))return-1;for(var n=0;n<i.ctx.times.length;n++)if(i.ctx.curTrack==(i.ctx.times[n].track||1)&&i.ctx.times[n].stime<=parseFloat(a)&&parseFloat(a)<i.ctx.times[n].etime)return n;if("2a"==t.wgtGetProperty(e,"v"))for(var n=0;n<i.ctx.times.length;n++)if(i.ctx.curTrack==(i.ctx.times[n].track||1)&&i.ctx.times[n].stime<=parseFloat(a)&&parseFloat(a)<i.ctx.times[n].etime+.1)return n;return-1},xa._buildTextPlain=function(t,e){for(var a,i="",n=t.wgtGetProperty(e,"subs"),r=0;r<n.length;r++)a=!1,r==n.length-1&&(a=!0),n[r].text.length&&"\n"==n[r].text[n[r].text.length-1]&&(a=!0),i+=n[r].text+(a?"":" ");return i},xa._buildText=function(t,e){function a(t,e){var a;if(a=apn.IWidget.exeFormatText(t),e){for(var i="",n=0;n<a.length;n++)i+=" "==a[n]&&" "==a[n+1]?"&nbsp;":a[n];a=i}return a}for(var i,n="",r=t.wgtGetProperty(e,"subs"),o="justify"==t.wgtGetProperty(e,"apxTextAlign"),d=0;d<r.length;d++)i=!1,d==r.length-1&&(i=!0),r[d].text.length&&"\n"==r[d].text[r[d].text.length-1]&&(i=!0),n+=t.wgtGetProperty(e,"vJ")?'<span id="'+d+'C" style="cursor:inherit;font-family:inherit;border-radius:3px;"><span id="'+d+'S" style="cursor:inherit;font-family:inherit;border-radius:3px;">'+a(r[d].text||"",o)+"</span></span>"+(i?"":" "):'<span id="'+d+'C" style="cursor:inherit;font-family:inherit;border-radius:3px;"><span id="'+d+'S" style="cursor:inherit;font-family:inherit;border-radius:3px;">'+(r[d].text||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</span></span>"+(i?"":" ");return this._convertLN(t,e,n)},xa._timeToSec=function(t){var e=(t||"").split(":"),a=60*bx.$checkNaN(parseInt(e[0]))+bx.$checkNaN(parseInt(e[1]))+bx.$checkNaN(parseInt(e[2]))/100;return a=Math.round(1e3*a)/1e3},xa._closest=function(t,e,a){for(var i,n=[],r=null,o=0;o<a.length;o++)i=t.wgtIntersectWith(void 0,e,1,a[o]),i&&i.length&&n.push(i[0]);return n.length>1?a=n:1==n.length&&(r=n[0]),r||(r=t.utlFindClosest(e,a)),r},xa._hhmmss999TOmmss99=function(t){function e(t){return 2==t.length?t:t.length>2?t.substring(0,2):t+"0"}var a=t.split(/[:.]/g);return 4==a.length?60*bx.$checkNaN(parseInt(a[0]))+bx.$checkNaN(parseInt(a[1]))+":"+a[2]+":"+e(a[3]):3==a.length?a[0]+":"+a[1]+":"+e(a[2]):""},xa._vttParse=function(t,e,a,i){function n(t){var e=t.replace(/\s+$/g,"");return e}if(!t||!t.split)return!1;for(var r,o=t.split("\n"),d=0,l=-1,s=0;s<o.length;s++)if(o[s]=n(o[s]),o[s].indexOf(":")>0&&o[s].indexOf("-->")>0){var p=o[s].split(" ");p.length>2&&"-->"==p[1]&&this._hhmmss999TOmmss99(p[0])&&this._hhmmss999TOmmss99(p[2])?(l++,!p[0]||p[0].indexOf(":")!=-1&&p[0].indexOf(".")!=-1||a&&void 0!==a.message&&(a.message+="Invalid time format in line "+(s+1)+". Time=["+p[0]+"]\n"),!p[2]||p[2].indexOf(":")!=-1&&p[2].indexOf(".")!=-1||a&&void 0!==a.message&&(a.message+="Invalid time format in line "+(s+1)+". Time=["+p[2]+"]\n"),e&&(e[l]={text:""},e[l].stime=this._hhmmss999TOmmss99(p[0]),e[l].etime=this._hhmmss999TOmmss99(p[2])),d=1):(a&&void 0!==a.message&&(a.message+="VTT parsing error in line "+(s+1)+".\r\n"),r=!0)}else 0==o[s].indexOf("NOTE")?d=2:o[s]&&1==d&&(parseInt(o[s])&&o[s+1]&&o[s+1].indexOf(":")>0&&o[s+1].indexOf("-->")>0||e&&(e[l].text+=(e[l].text?"\n":"")+o[s]));if(i)for(var s=0;s<e.length;s++)e[s].text&&(e[s].text=e[s].text.replace(/<br\/>/g,"\n"));return l==-1&&(a&&void 0!==a.message&&(a.message+="This file is empty.\r\n"),r=!0),!r},xa.edtOnConfig=function(t,e,a,i,n){function r(){if(!n||!n.readOnly)if(eduLib.edtInputApplyAll(t,y.tagSub1),eduLib.edtInputApplyAll(t,y.tagSub2),eduLib.edtInputApplyAll(t,y.tagSub3),t.wgtSetProperty(e,"cfg",b),t.wgtSetProperty(e,"subs",S),"2a"==s)"Y"==b.bgP?t.wgtSetProperty(e,"apxBackgroundTick","Y"):t.wgtSetProperty(e,"apxBackgroundTick","");else{if(b.txt="",b.mode)for(var a,i=0;i<S.length;i++)a=!1,i==S.length-1&&(a=!0),S[i].text.length&&"\n"==S[i].text[S[i].text.length-1]&&(a=!0),S[i].txtPos=b.txt.length,b.txt+=S[i].text+(a?"":" ");t.wgtSetProperty(e,"apxText",b.txt)}}function o(){for(var t in v)this.id==t?(y[t].style.display="block",y.tagTab.$$(t).style.borderStyle="solid solid none solid"):(y[t].style.display="none",y.tagTab.$$(t).style.borderStyle="none none solid none");eduWgtSubtitle._uiLastSetupTab2A=this.id}function d(a,i){if(a){var n=[];if(m._vttParse(a,n,i,t.wgtGetProperty(e,"vBR")))return S=n,eduLib.edtInputClear(t,y.tagSub1),eduLib.edtInputAdd(t,y.tagSub1,{type:"table",value:S,options:{th:[{title:"Start Time[?]",comment:"(MM:SS.99)"},{title:"End Time[?]",comment:"(MM:SS.99)"},"Subtitle"],add:!0,remove:!0},td:[{type:"timeMMSS99",key:"stime",width:"180px"},{type:"timeMMSS99",key:"etime",width:"180px"},{type:"text",key:"text",multiline:!0}]}),!0}return!1}function l(){"s1"==this.value?eduLib.edtInputShow(t,y.tagSub2,"mode_s1",!0):eduLib.edtInputShow(t,y.tagSub2,"mode_s1",!1),this.value&&"s"==this.value[0]?eduLib.edtInputShow(t,y.tagSub2,"mode",!0):eduLib.edtInputShow(t,y.tagSub2,"mode",!1)}var s;if(!(s=t.wgtGetProperty(e,"v")))return void this._edtOnConfigV1(t,e,a,i,n);var p=t.getScreenData(),c=[];for(var u in p.objects)p.objects[u].create&&p.objects[u].create.data&&p.objects[u].create.data.properties&&p.objects[u].create.data.properties.attrs&&p.objects[u].create.data.properties.attrs.apxMediaControl&&c.push({value:u,title:t.itrGetObjectTitle(u)});if(c.push({value:"",title:apn.CExe.GL(apn.CExe.TXT_SETUP_NOSEL)}),"2a"==s){var x,g=[];for(var u in p.objects)x=apn.Project.getStateByObjectID(t.getData(),t.getPageID(),u),x&&g.push({value:u,title:t.itrGetObjectTitle(u)+" with "+x.length+" state"+(x.length>1?"s":"")});g.push({value:"",title:apn.CExe.GL(apn.CExe.TXT_SETUP_NOSEL)})}var y,b=t.wgtGetProperty(e,"cfg"),S=t.wgtGetProperty(e,"subs");b.ptpVolFade=b.ptpVolFade||0;var v={tagSub1:!0,tagSub2:!0,tagSub3:!0},m=this,f={en:"※ For CJK(Chinese,Japanese,Korean), VTT file needs to be encoded in UTF-8. Also, VTT parser doesn't support CSS styling information.",ko:"※ 한국어, 중국어, 일본어(CJK)를 사용하는 경우, VTT 파일이 UTF-8으로 인코딩되어야 합니다. 그리고, 이 VTT 분석기는 VTT에 포함된 CSS 스타일을 인식하지 않습니다.",ja:"※韓国語、中国語、日本語（CJK）を使用する場合は、VTTファイルがUTF-8でエンコードする必要があります。そして、このVTTアナライザは、VTTに含まれるCSSスタイルを認識しません。"},h={en:"※ To break the line, you can enter line-break from 'Subtitle' field.",ko:"※ 표시되는 문장의 줄을 바꾸기 위해서는, 'Subtile'에 항목에서 줄바꿈을 입력하면 됩니다.",ja:"※表示されている文章の行を変更するには、「Subtile」項目で改行を入力します。"},T={en:"※ Also, you can sync with more widgets using 'Widget Event' from this widget.",ko:"※ 또한, 'Widget Event'를 통하여 다수의 Widget과 Sync할 수 있습니다.",ja:"※また、「Widget Event」で多数のWidgetとSyncすることができます。"},k={en:"※ Some devices may not support 'Volume fade in/out'.",ko:"※ '음량 페이드 인아웃'를 지원하지 않는 기기도 있습니다.",ja:"※「音量フェードインアウト」をサポートしていない機器もあります。"},P={en:"※ In case of 'Play touched section only', to start or resume the media, you need to clear the play section by Scripting.",ko:"※ '구간 Play' 방식을 사용하는 경우, 터치에 의하여 지정된 구간을 해제하고 처음부터 Play하기 위해서는 Script로 구간을 해제하고 Play해야 합니다.",ja:"※「区間Play」方式を使用する場合は、タッチによって指定された区間を解除して初めからPlayするためにはScriptで区間を解除してPlayする必要があります。"};if("2a"==s)var w=apn.CExe.GL({ko:"구간 정보",en:"Track data",ja:"区間情報"}),C=apn.CExe.GL({ko:"연동할 미디어 위젯",en:"Media widget to sync with",ja:"連動するメディアウィジェット"});else var w=apn.CExe.GL({ko:"자막",en:"Subtitle",ja:"字幕"}),C=apn.CExe.GL({ko:"연동할 미디어 위젯",en:"Media widget to subtitle",ja:"連動するメディアウィジェット"});if(n&&n.readOnly&&(n.title=t.itrGetObjectTitle(e)),y=t.dlgDoModal(860,Math.floor(.9*bx.UX.height),r,void 0,n)){y.style.padding="12px",y.style.boxSizing="border-box";var L=apn.CExe.CSS_SETUP_PANE+"height:"+(y.clientHeight-40-24)+"px";y.tagTab=y.$TAG("div",{style:"position:relative;font-weight:bold;width:100%;height:26px;padding-bottom:14px;"}),y.tagTab.innerHTML='<span id="tagSub2" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"설정",en:"Setup",ja:"設定"})+'</span><span id="tagSub1" style="'+apn.CExe.CSS_SETUP_TAB+'">'+w+'</span><span id="tagSub3" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"VTT파일에서 읽기",en:"Import from VTT",ja:"VTTファイルで読み取る"})+"</span>"+apn.CExe.CSS_SETUP_TAB_END,y.tagTab.$$("tagSub1").onclick=y.tagTab.$$("tagSub2").onclick=y.tagTab.$$("tagSub3").onclick=o,y.tagSub1=y.$TAG("div",{style:L}),y.tagSub2=y.$TAG("div",{style:L}),y.tagSub3=y.$TAG("div",{style:L}),n&&n.readOnly&&(eduLib.edtInputDisable(t,y.tagSub1),eduLib.edtInputDisable(t,y.tagSub2),eduLib.edtInputDisable(t,y.tagSub3),y.tagTab.$$("tagSub3").style.display="none",window.ResizeObserver&&new ResizeObserver(function(){y.tagTab.$$("tagBlank").style.width=y.clientWidth-24-(y.tagTab.$$("tagSub1").offsetLeft+y.tagTab.$$("tagSub1").offsetWidth)-1+"px"}).observe(y)),"2"==s?(eduLib.edtInputAdd(t,y.tagSub1,{type:"table",value:S,options:{th:[{title:apn.CExe.GL({ko:"시작 시간",en:"Start Time",ja:"開始時間"})+"[?]",comment:"(MM:SS.99)"},{title:apn.CExe.GL({ko:"종료 시간",en:"End Time",ja:"終了時間"})+"[?]",comment:"(MM:SS.99)"},apn.CExe.GL({ko:"자막 문구",en:"Subtitle",ja:"字幕文句"})],add:!0,remove:!0},td:[{type:"timeMMSS99",key:"stime",width:"180px"},{type:"timeMMSS99",key:"etime",width:"180px"},{type:"text",key:"text",multiline:!0}],join:!0}),eduLib.edtInputAdd(t,y.tagSub1,{type:"message",value:apn.CExe.GL(h),join:!0})):eduLib.edtInputAdd(t,y.tagSub1,{type:"table",value:S,options:{th:[{title:apn.CExe.GL({ko:"시작 시간",en:"Start Time",ja:"開始時間"})+"[?]",comment:"(MM:SS.99)"},{title:apn.CExe.GL({ko:"종료 시간",en:"End Time",ja:"終了時間"})+"[?]",comment:"(MM:SS.99)"},{title:apn.CExe.GL({ko:"구간 제목",en:"Title of Track",ja:"区間タイトル"}),comment:apn.CExe.GL({ko:"(Event로 발생되거나 Layer 제목과 맵핑됨)",en:"(Use as Event title or mapped with Layer by title)",ja:"（Eventで発生したり、Layerタイトルとマッピングされる）"})},{title:apn.CExe.GL({ko:"이 구간에서 멈춤",en:"Pause on track[?]",ja:"この区間で停止"}),comment:apn.CExe.GL({ko:"(이 구간이 시작될 때 미디어 멈춤)",en:"(Pause media on entering this track)",ja:"（この区間が開始されると、メディアが停止する）"})}],add:!0,remove:!0},td:[{type:"timeMMSS99",key:"stime",width:"180px"},{type:"timeMMSS99",key:"etime",width:"180px"},{type:"text",key:"text",multiline:!0},{type:"select",key:"pOes",options:[{title:"Yes",value:"Y"},{title:"No",value:"N"}],width:"120px"}],join:!0}),c.length&&(eduLib.edtInputAdd(t,y.tagSub2,{type:"select",options:c,title:C,key:"idMedia",value:b,join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"space"})),"2"==s?(eduLib.edtInputAdd(t,y.tagSub2,{type:"title",title:apn.CExe.GL({ko:"자막 표시",en:"Display text track",ja:"字幕表示"}),join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"select",title:apn.CExe.GL({ko:"표시 방식",en:"Display",ja:"表示方式"}),key:"mode",value:b,options:[{title:apn.CExe.GL({ko:"일반 자막",en:"Each text track",ja:"一般字幕"}),value:""},{title:apn.CExe.GL({ko:"자막을 문단으로 합치고, 활성자막 배경색 강조",en:"Merge as a sentence and highlight track background",ja:"字幕を段落に合わせ、アクティブ字幕の背景色を強調"}),value:"s0"},{title:apn.CExe.GL({ko:"자막을 문단으로 합치고, 활성자막 텍스트 강조",en:"Merge as a sentence and highlight track text",ja:"字幕を段落に合わせ、アクティブ字幕テキストを強調"}),value:"s1"}],onchange:l,join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode",type:"color",title:apn.CExe.GL({ko:"활성자막 색상",en:"Highlight color",ja:"アクティブ字幕の色"}),key:"modeClr",value:b,askUse:!0,join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode_s1",type:"select",title:apn.CExe.GL({ko:"활성자막에 볼드체 표시",en:"Bold font",ja:"アクティブ字幕に太字表示"}),key:"modeBold",value:b,options:[{title:apn.CExe.GL({ko:"예",en:"Yes",ja:"はい"}),value:"Y"},{title:apn.CExe.GL({ko:"아니오",en:"No",ja:"いいえ"}),value:"N"}],join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode",type:"select",title:apn.CExe.GL({ko:"줄바꿈 표시 간격",en:"Line-break margin",ja:"改行表示間隔"}),key:"yMrg",value:b,options:[{title:apn.CExe.GL({ko:"기본 간격",en:"Normal",ja:"基本間隔"}),value:"1"},{title:apn.CExe.GL({ko:"좁게",en:"Narrower",ja:"狭くする"}),value:"2"},{title:apn.CExe.GL({ko:"넓게",en:"Wider",ja:"広くする"}),value:""}],join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode",type:"space"}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode",type:"title",title:apn.CExe.GL({ko:"터치에 의한 구간 Play",en:"Section play by touch",ja:"タッチによる区間Play"}),join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode",type:"select",title:apn.CExe.GL({ko:"Play 방식",en:"Play by touch",ja:"Play方式"}),key:"ptp",value:b,options:[{title:apn.CExe.GL({ko:"터치된 자막에서부터 Play",en:"Play from touched text",ja:"タッチされた字幕からPlay"}),value:"S"},{title:apn.CExe.GL({ko:"터치된 자막만 구간 Play",en:"Play touched section only",ja:"タッチされた字幕のみ区間Play"}),value:"R"},{title:apn.CExe.GL({ko:"기능 사용 안함",en:"No",ja:"機能を無効にする"}),value:"N"}],join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode",type:"color",title:apn.CExe.GL({ko:"마우스 호버 색상",en:"Hover color",ja:"マウスオーバー色"}),key:"ptpClr",value:b,askUse:!0,join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode",type:"select",title:apn.CExe.GL({ko:"마우스 호버에서 볼드체 표시",en:"Bold font on Hover",ja:"マウスオーバーで太字表示"}),key:"ptpBold",value:b,options:[{title:apn.CExe.GL({ko:"예",en:"Yes",ja:"はい"}),value:"Y"},{title:apn.CExe.GL({ko:"아니오",en:"No",ja:"いいえ"}),value:"N"}],join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode",type:"number",title:apn.CExe.GL({ko:"음량 페이드 인아웃[초]",en:"Volume fade in/out[sec]",ja:"音量フェードインアウト[秒]"}),key:"ptpVolFade",value:b,min:0,step:.05,join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode",type:"message",value:apn.CExe.GL(k),join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{id:"mode",type:"message",value:apn.CExe.GL(P),join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"space"}),eduLib.edtInputAdd(t,y.tagSub2,{type:"title",title:apn.CExe.GL({ko:"키워드 강조",en:"Keyword highlight",ja:"キーワードを強調"}),join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"color",title:apn.CExe.GL({ko:"강조 색상",en:"Highlight color",ja:"ハイライトカラー"}),key:"colorFocus",value:b,join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"message",value:apn.CExe.GL({ko:"※ 텍스트에서 [[  ]]로 표시한 부분이 강조됩니다.",en:"※  Embrace with [[  ]] to highlight words",ja:"※テキストの[[]]で表示した部分が強調されます。"}),join:!0})):(eduLib.edtInputAdd(t,y.tagSub2,{type:"title",title:apn.CExe.GL({ko:"컨테이너 위젯과 자동으로 연동",en:"Automatically sync with",ja:"コンテナウィジェットと自動的に連動"}),join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"select",options:g,title:apn.CExe.GL({ko:"연동할 위젯",en:"Layer/scene container",ja:"連動するウィジェット"}),key:"idTarget",value:b,join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"select",title:apn.CExe.GL({ko:"[None] 상태 연동",en:"Sync [None] state",ja:"[None]状態連動"}),key:"syncStateN",value:b,options:[{title:apn.CExe.GL({ko:"예",en:"Yes",ja:"はい"}),value:"Y"},{title:apn.CExe.GL({ko:"아니오",en:"No",ja:"いいえ"}),value:""}],join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"message",value:apn.CExe.GL(T),join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"space"}),eduLib.edtInputAdd(t,y.tagSub2,{type:"title",title:apn.CExe.GL({ko:"추가 설정",en:"More options",ja:"追加設定"}),join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"select",title:apn.CExe.GL({ko:"Seek이 실행되면 현재 구간 지정 해제",en:"Clear current track on seek",ja:"Seekが実行されると、現在の区間指定解除"}),key:"v2aRS",value:b,options:[{title:apn.CExe.GL({ko:"예",en:"Yes",ja:"はい"}),value:"Y"},{title:apn.CExe.GL({ko:"아니오",en:"No",ja:"いいえ"}),value:""}],join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"select",title:apn.CExe.GL({ko:"배경음과 연동",en:"Play with the background audio",ja:"背景音と連動"}),key:"bgP",value:b,options:[{title:apn.CExe.GL({ko:"예",en:"Yes",ja:"はい"}),value:"Y"},{title:apn.CExe.GL({ko:"아니오",en:"No",ja:"いいえ"}),value:""}],join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"number",title:apn.CExe.GL({ko:"음량 페이드 인아웃[초]",en:"Volume fade in/out[sec]",ja:"音量フェードインアウト[秒]"}),key:"ptpVolFade",value:b,min:0,step:.05,join:!0}),eduLib.edtInputAdd(t,y.tagSub2,{type:"message",value:apn.CExe.GL(k),join:!0})),eduLib.edtInputAdd(t,y.tagSub3,{type:"file",accept:".vtt",title:apn.CExe.GL({ko:"VTT 파일",en:"VTT file",ja:"VTTファイル"}),value:b,key:"vtt",oncheck:d,join:!0}),eduLib.edtInputAdd(t,y.tagSub3,{type:"message",value:apn.CExe.GL(f),join:!0}),void 0!==eduWgtSubtitle._uiLastSetupTab2A&&y.tagTab.$$(eduWgtSubtitle._uiLastSetupTab2A)?y.tagTab.$$(eduWgtSubtitle._uiLastSetupTab2A).onclick():y.tagTab.$$("tagSub2").onclick(),y.tagTab.$$("tagBlank").style.width=y.clientWidth-24-y.tagTab.$$("tagBlank").offsetLeft-1+"px"}},xa.edtOnRemapObjectID=function(t,e,a){if(e&&e.properties&&e.properties.attrs&&e.properties.attrs.cfg){var i=e.properties.attrs.cfg;i.idMedia&&(a[i.idMedia]?i.idMedia=a[i.idMedia]:t.getScreenData().objects[i.idMedia]||(i.idMedia="")),i.idTarget&&(a[i.idTarget]?i.idTarget=a[i.idTarget]:t.getScreenData().objects[i.idTarget]||(i.idTarget=""))}},xa.edtOnBuildEvent=function(t,e,a,i,n){var r=t.pages[a].objects[e].create.data.properties.attrs.v;if(r&&"2"==r[0]){var o=t.pages[a].objects[e].create.data.properties.attrs.subs;if(i.wgtEvent={value:"wgtEvent",title:apn.P.eventTitle.wgtEvent,param:{}},o.length)for(var d=0;d<o.length;d++)"2a"==r?o[d].text&&(i.wgtEvent.param[o[d].text]=o[d].text):i.wgtEvent.param[d+1]=d+1+"";var l=apn.Project.findITRs(t,a,e);if(l&&l.length){var s;for(d=0;d<l.length;d++)s=apn.P.resolveCompositeSysEV(l[d].event),!s||!s.param||"wgtEvent"!=s.ev||i.wgtEvent&&i.wgtEvent.param[s.param]||(i.wgtEvent=i.wgtEvent||{value:"wgtEvent",title:apn.P.eventTitle.wgtEvent,param:{}},i.wgtEvent.param[s.param]=s.param)}i.wgtEvent.param["[None]"]="[None]"}},xa.edtOnBuildState=function(t,e,a,i){var n=t.pages[a].objects[e].create.data.properties.attrs.v;if(n&&"2"==n[0]){i.r="Ready",i.disd="Disabled";for(var r=t.pages[a].objects[e].create.data.properties.attrs.subs,o=0;o<r.length;o++)"2a"==n?r[o].text&&(i["p_"+r[o].text]="Play "+r[o].text):i["p_"+(o+1)]="Play "+(o+1);for(i.pNxt="Play Next",i.pPrv="Play Prev",o=0;o<r.length;o++)"2a"==n&&r[o].text&&(i["part_"+r[o].text]="PlayPart "+r[o].text);for(o=0;o<r.length;o++)"2a"==n?r[o].text&&(i["s_"+r[o].text]="PlaySection "+r[o].text):i["s_"+(o+1)]="PlaySection "+(o+1);i.sNxt="PlaySection Next",i.sPrv="PlaySection Prev",i.sC="ClearSection"}},xa._edtOnConfigV1=function(t,e,a,i,n){function r(){n&&n.readOnly||(t.getObjectByID(e).data.styles.textMultiLine=!0,eduLib.edtInputApplyAll(t,o),t.wgtSetProperty(e,"cfg",d),t.wgtSetProperty(e,"subs",l))}var o,d=t.wgtGetProperty(e,"cfg"),l=t.wgtGetProperty(e,"subs");n&&n.readOnly&&(n.title=t.itrGetObjectTitle(e)),(o=t.dlgDoModal(800,600,r,void 0,n))&&(n&&n.readOnly&&eduLib.edtInputDisable(t,o),t.wgtGetProperty(e,"noMultiTrack")?eduLib.edtInputAdd(t,o,{type:"table",value:l,options:{th:[{title:"Start Time[?]",comment:"(MM:SS.99)"},{title:"End Time[?]",comment:"(MM:SS:99)"},"Subtitle"],add:!0,remove:!0},td:[{type:"timeMMSS99",key:"stime",width:"180px"},{type:"timeMMSS99",key:"etime",width:"180px"},{type:"text",key:"text",multiline:!0}]}):eduLib.edtInputAdd(t,o,{type:"table",value:l,options:{
th:["Track#",{title:"Start Time[?]",comment:"(MM:SS.99)"},{title:"End Time[?]",comment:"(MM:SS:99)"},"Subtitle"],add:!0,remove:!0},td:[{type:"text",key:"track",width:"50px"},{type:"timeMMSS99",key:"stime",width:"180px"},{type:"timeMMSS99",key:"etime",width:"180px"},{type:"text",key:"text",multiline:!0}]}),eduLib.edtInputAdd(t,o,{type:"space"}),eduLib.edtInputAdd(t,o,{type:"title",title:"More options"}),eduLib.edtInputAdd(t,o,{type:"color",title:"Highlight Color",key:"colorFocus",value:d,comment:"(Embrace with [[   ]] to highlight words)"}))},xa.pubOnGetText=function(t,e,a){var i,n=t.pages[e].objects[a].create.data;n.styles&&n.styles.font&&(i=n.styles.font),i=apn.Project.resolveStyle(t,"font",i);var r=n.properties.attrs,o="";if(!r.v||"2"==r.v)for(var d=0;d<r.subs.length;d++)o+=r.subs[d].text||"";return[{font:i,str:o}]},xa.pubOnGetFontList=function(t,e,a){var i=this.pubOnGetText(t,e,a);return i[0].font&&i[0].str?[i[0].font]:null},eduWgtSubtitle=xa;var xa=apn.inheritWidget(eduWgtSubtitle);xa.styleMap={title:!0},xa.APX_NO_POINTER_EV=!0,xa.exeItrNoResize=!0,xa.exeItrNoZoom=!0,xa.exeItrNoMove=!0,xa.apdConfigReadOnly=!0,xa.properties.attrs.v="2a",xa.properties.attrs.noMultiTrack=!0,xa.apnCImage={url:"DB/EDU/imgs/wgts/edit/mediaAnnt.png"},xa.createAsCanvasObject=function(t,e,a,i,n){return apn.IWidget.createCanvasObject(t,this,"apn.CImage",bx.CCanvasWnd.SHAPE_RECT,e,a,i,n,void 0,apn.CEditorS.NO_RESIZE)},xa._setupSpaned=eduWgtSubtitle._setupSpaned,xa._refresh=eduWgtSubtitle._refresh,xa._convertLN=eduWgtSubtitle._convertLN,xa._findkSub=eduWgtSubtitle._findkSub,xa._buildTextPlain=eduWgtSubtitle._buildTextPlain,xa._buildText=eduWgtSubtitle._buildText,xa._timeToSec=eduWgtSubtitle._timeToSec,xa._closest=eduWgtSubtitle._closest,xa._hhmmss999TOmmss99=eduWgtSubtitle._hhmmss999TOmmss99,xa._vttParse=eduWgtSubtitle._vttParse,eduWgtMediaAntn=xa;
var xa={APX_NO_POINTER_EV:!0};xa.styleMap={title:!0},xa.exeItrNoResize=!0,xa.exeItrNoZoom=!0,xa.exeItrNoMove=!0,xa.editor={},xa.editor.states={on:"On",off:"Off"},xa.editor.properties={Interval:{title:"Interval[ms]",input:null,type:"number"},Offset:{title:"Offset[±ms]",input:null,type:"number"},noST:{title:"FireOnStart",input:[{title:"Yes",value:""},{title:"No",value:"Y"}]},apxBackgroundTick:{title:"Daemon",input:[{title:"On",value:"Y"},{title:"Off",value:""}]},apxAllowBubble:{title:"Bubbling",input:[{title:"Yes",value:"Y"},{title:"No",value:""}]}},xa.apnCImage={url:"DB/ux/imgs/wgts/edit/timer_on.png"},xa.properties={},xa.properties.state="off",xa.properties.attrs={Interval:1e3,Offset:0,apxBackgroundTick:"",noST:"",apxAllowBubble:""},xa.MIN=25,xa.createAsCanvasObject=function(t,e,a,r,n){return apn.IWidget.createCanvasObject(t,this,"apn.CImage",bx.CCanvasWnd.SHAPE_RECT,e,a,r,n,void 0,apn.CEditorS.NO_RESIZE)},xa.exeCreateTag=function(t,e,a,r,n,i){var o=document.body.$TAG("div",{style:"position:absolute;overflow:hidden;"});return o.apnCur={},i&&e.wgtHide&&e.wgtHide(i),o},xa.exeRenderTag=function(t,e,a,r,n,i){return a},xa.exeOnLoad=function(t,e){var a=bx.$checkNaN(parseInt(t.wgtGetProperty(e,"Offset"))),r=bx.$checkNaN(parseInt(t.wgtGetProperty(e,"Interval")));r<uxWgtTimer.MIN&&(r=uxWgtTimer.MIN);var n=t.wgtTag(e);n._interval=r,n._offset=a},xa.exeOnStart=xa.exeOnResume=function(t,e){var a=t.wgtTag(e);a.__state="on"==t.wgtGetProperty(e,"apxState"),a._tm=0},xa.exeOnTick=function(t,e,a){var r=t.wgtTag(e);if(r.__state){if(0===r._tm&&"Y"==t.wgtGetProperty(e,"noST"))return void(r._tm=a+r._interval);(0===r._tm||r._tm<=a)&&(t.fireEvent("timer",void 0,e,"Y"==t.wgtGetProperty(e,"apxBackgroundTick")),r._tm=a+Math.max(uxWgtTimer.MIN,r._interval+Math.floor(r._offset*(Math.random()-.5)*2)))}},xa.exeSetState=function(t,e,a){e.__state="on"==a,e._tm=0},xa.edtOnSetState=function(t,e,a){var r=t.wgtGetProperty(e,"Interval");r=bx.$checkNaN(parseInt(r)),r<uxWgtTimer.MIN&&(r=uxWgtTimer.MIN,t.wgtSetProperty(e,"Interval",r)),t.wgtSetProperty(e,"URL","DB/ux/imgs/wgts/edit/timer_"+a+".png"),t.setMediaToObject(e,"DB/ux/imgs/wgts/edit/timer_"+a+".png")},xa.edtOnBuildEvent=function(t,e,a,r){r.timer={value:"timer",title:apn.P.eventTitle.timer}},uxWgtTimer=xa;
var xa;xa=apn.inheritWidget(apn.widgets["apn.wgt.image"]),xa.editor={},xa.editor.iconThumb="DB/EDU/imgs/wgts/thumbs/spriteAnimation.png",xa.editor.states={play:"Play",loop:"Loop",stop:"Stop"},xa.properties.state="stop",xa.properties.attrs={apxAnimate:!0,cfg:{frames:[{sprite:{mediaID:void 0},duration:42}],idStep:""}},xa.onEdit=void 0,xa.exeCreateTag=apn.widgets["apn.wgt.rect"].exeCreateTag,xa.exeRenderTag=apn.widgets["apn.wgt.rect"].exeRenderTag,xa.exeAssetLoad=void 0,xa.exeAssetPreload=function(e,t,a){function i(i,s,c){a(),uxWgtImgSprite._frame(e,n,n.ctx.cur),r.exeOnCheckContentLoad&&e.fireEvent("contentLoad","i",t,!0,e.project.property.allowImmediateContentLoad)}var r=this,n=e.wgtTag(t);n.ctx={},n.ctx.frames=[],n.ctx.cur=0,n.ctx.action=0,n.ctx.lastTickTime=0;for(var s=e.wgtGetProperty(t,"cfg"),c=0,o={},d=0;d<s.frames.length;d++)buf=bx.$cloneObject({},s.frames[d]),buf.duration=bx.$checkNaN(parseInt(buf.duration)),buf.sprite.mediaID&&buf.duration&&(o["sp"+d]={url:e.mediaURL(s.frames[d].sprite.mediaID)},c++,buf.img=o["sp"+d],n.ctx.frames.push(buf));c?(new apn.CRscLoader).load(e.project,o,i):a()},xa.exeOnLoad=function(e,t){function a(a,n){if(a==r.idStep&&n){if(!i.ctx.frames[n.current])return void e.log(t,"Invalid frame was requested to display by step interface. FrameIndex="+n.current);i.ctx.cur!=n.current&&n.current<i.ctx.frames.length&&(i.ctx.cur=n.current,uxWgtImgSprite._frame(e,i,i.ctx.cur))}}var i=e.wgtTag(t),r=e.wgtGetProperty(t,"cfg");bx.HCL.DV.isIE()&&bx.HCL.DV.isIE()<9?i.img=i.$TAG("img",{style:"cursor:inherit;position:absolute;left:0px;top:0px;width:100%;height:100%;"}):(i.canvas=i.$TAG("canvas",{style:"cursor:inherit;position:absolute;left:0px;top:0px;width:100%;height:100%;"}),i.canvas.width=parseInt(i.style.width),i.canvas.height=parseInt(i.style.height)),uxWgtImgSprite._frame(e,i,i.ctx.cur),r.idStep&&e.wgtListenProperty(t,"apxStep",a)},xa.exeOnCheckContentLoad=function(e,t,a){return{i:"Image"}},xa.exeSetState=function(e,t,a,i){"stop"==a?this._stop(e,t,!0):"play"==a?(t.ctx.action=1,t.ctx.lastTickTime=0,e.fireEvent("animation","Start",e.wgtId(t))):"loop"==a&&(t.ctx.action=2,t.ctx.lastTickTime=0,e.fireEvent("animation","Start",e.wgtId(t)))},xa.exeOnTick=function(e,t,a){var i=e.wgtTag(t);if(i.ctx&&i.ctx.frames.length&&0!=i.ctx.action){i.ctx._onceStarted=!0;var r;0==i.ctx.lastTickTime?(i.ctx.cur=0,r=!0):i.ctx.lastTickTime<a&&(r=!0,2==i.ctx.action?i.ctx.cur=(i.ctx.cur+1)%i.ctx.frames.length:(i.ctx.cur++,i.ctx.cur==i.ctx.frames.length&&(i.ctx.cur=0,this._stop(e,i),r=!1))),r&&(i.ctx.lastTickTime=a+parseInt(i.ctx.frames[i.ctx.cur].duration),uxWgtImgSprite._frame(e,i,i.ctx.cur))}},xa._frame=function(e,t,a){if(t.ctx.frames[a]&&t.ctx.frames[a].img.image)if(t.canvas){var i=t.canvas.getContext("2d");i.clearRect(0,0,i.canvas.width,i.canvas.height),i.drawImage(t.ctx.frames[a].img.image,0,0,i.canvas.width,i.canvas.height)}else t.img&&(t.img.src=t.ctx.frames[a].img.url)},xa._stop=function(e,t,a){t.ctx.action=0,t.ctx.lastTickTime=0,a&&t.ctx.frames[0]&&t.ctx.frames[0].sprite.mediaID&&(t.ctx.cur=0,uxWgtImgSprite._frame(e,t,0)),t.ctx._onceStarted&&e.fireEvent("animation","End",e.wgtId(t))},xa.edtSetupStep=function(e,t,a,i){var r=e.getScreenData(),n=[{title:apn.CExe.GL({ko:"[없음]",en:"[None]",ja:"[なし]"}),value:""}];for(var s in r.objects)r.objects[s].create&&r.objects[s].create.data&&r.objects[s].create.data.properties&&r.objects[s].create.data.properties.attrs&&r.objects[s].create.data.properties.attrs.apxStep&&n.push({value:s,title:e.itrGetObjectTitle(s)});eduLib.edtInputAdd(e,a,{type:"select",options:n,title:apn.CExe.GL({ko:"연동할 위젯",en:"Widget to interface with",ja:"連動するウィジェット"}),key:"idStep",value:i,join:!0})},xa.edtOnConfig=function(e,t){function a(){eduLib.edtInputApplyAll(e,r.tagTab1),eduLib.edtInputApplyAll(e,r.tagTab2),n.frames[0].sprite.mediaID&&e.wgtSetProperty(t,"apxMediaID",n.frames[0].sprite.mediaID),e.wgtSetProperty(t,"cfg",n),e.wgtRefreshUI(t)}function i(){for(var e in s)s[e]&&(this.id==e?(r[e].style.display="block",r.tagTab.$$(e).style.borderStyle="solid solid none solid"):(r[e].style.display="none",r.tagTab.$$(e).style.borderStyle="none none solid none"));uxWgtImgSprite._uiLastSetupTab=this.id}var r,n=e.wgtGetProperty(t,"cfg"),s={tagTab1:!0,tagTab2:!0};if(r=e.dlgDoModal(600,Math.ceil(.9*bx.UX.height),a)){var c=apn.CExe.CSS_SETUP_PANE+"height:"+(r.clientHeight-40)+"px";r.tagTab=r.$TAG("div",{style:"position:relative;font-weight:bold;width:100%;height:26px;padding-bottom:14px;"}),r.tagTab.innerHTML='<span id="tagTab1" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"스프라이트",en:"Sprite Sheet",ja:"スプライト"})+'</span><span id="tagTab2" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"스텝 연동",en:"Step Interface",ja:"ステップ連動"})+"</span>"+apn.CExe.CSS_SETUP_TAB_END,r.tagTab.$$("tagTab1").onclick=r.tagTab.$$("tagTab2").onclick=i,r.tagTab1=r.$TAG("div",{style:c}),r.tagTab2=r.$TAG("div",{style:c}),eduLib.edtInputAdd(e,r.tagTab1,{type:"table",value:n.frames,options:{th:[apn.CExe.GL({ko:"프레임 이미지",en:"Frame image",ja:"フレーム画像"}),apn.CExe.GL({ko:"프레임 시간",en:"Duration",ja:"フレーム時間"})+"[ms]"],add:!0,remove:!0,order:!0},td:[{type:"image",key:"sprite"},{type:"text",key:"duration",width:"110px"}],join:!0}),eduLib.edtInputAdd(e,r.tagTab1,{type:"message",value:"※ "+apn.CExe.GL({ko:"과도한 이미지의 사용은 HTML5 컨텐츠의 성능을 크게 저하시킵니다. 그러한 경우, Video로 제작하거나 Scene Animation으로 편집하는 것이 좋습니다.",en:"Excessive image resources will slow down HTML5 contents. In that case, video or Scene Animation is better.",ja:"過度な画像の使用は、HTML5コンテンツのパフォーマンスを大幅に低下させます。その場合、Videoでの製作や、Scene Animationでの編集をお勧めします。"}),join:!0}),this.edtSetupStep(e,t,r.tagTab2,n),void 0!==uxWgtImgSprite._uiLastSetupTab&&r.tagTab.$$(uxWgtImgSprite._uiLastSetupTab)?r.tagTab.$$(uxWgtImgSprite._uiLastSetupTab).onclick():r.tagTab.$$("tagTab1").onclick(),r.tagTab.$$("tagBlank").style.width=r.clientWidth-r.tagTab.$$("tagBlank").offsetLeft-1+"px"}},xa.edtOnRemapObjectID=function(e,t,a){if(t&&t.properties&&t.properties.attrs&&t.properties.attrs.cfg){var i=t.properties.attrs.cfg;i.idStep&&(a[i.idStep]?i.idStep=a[i.idStep]:e.getScreenData().objects[i.idStep]||(i.idStep=""))}},uxWgtImgSprite=xa,xa=apn.inheritWidget(uxWgtImgSprite),xa.properties.attrs.imgCropSprite=!0,xa.properties.attrs.ver=2,xa.properties.attrs.cfg={ty:"s",mr:0,s:{img:{mediaID:void 0},w:64,h:64,cnt:1,cols:0,x:0,y:0,tm:42,tmSet:""},f:{file:{size:0,data:""},edt:{}},idStep:""},xa.scriptInfo={wgtData:{sheet:{help:"{type:'simple', data:{img:{mediaID:id}, w:Number, h:Number, cnt:Number, x:Number, y:Number, tm:Msec}\nSprite sheet data.",type:"so"}},wgtRun:{showFrame:{param:"1-based Number",help:{ko:"지정된 프레임을 표시합니다.",en:"Show the designated frame",ja:"指定されたフレームを表示します。"}}}},xa.exeCreateTag=apn.widgets["apn.wgt.rect"].exeCreateTag,xa.exeRenderTag=function(e,t,a,i,r,n){return apn.widgets["apn.wgt.rect"].exeRenderTag.call(this,e,t,a,i,r,n),a.tagOnPostResize=function(e,t){if(t.ctx.cellHolder){var a=e.wgtGetProperty(t.apnOID,"cfg"),i=1,r=parseInt(t.style.width)/(a.s.w*i),n=parseInt(t.style.height)/(a.s.h*i);r=parseInt(t.style.width)/a.s.w,n=parseInt(t.style.height)/a.s.h,t.ctx.cellHolder.$CSS({transform:"scale("+r*i+","+n*i+")",transformOrigin:"0px 0px"})}},a},xa.exeAssetPreload=function(e,t,a){function i(i,o,d){r.ctx.image=s.sp.image,c._loadSpriteSheet(e,t,n),a(),c.exeOnCheckContentLoad&&e.fireEvent("contentLoad","i",t,!0,e.project.property.allowImmediateContentLoad)}var r=e.wgtTag(t);r.ctx={},r.ctx.cur=0,r.ctx.action=0,r.ctx.lastTickTime=0,r.ctx.frames=[];var n=e.wgtGetProperty(t,"cfg");if(n.s.img.mediaID){var s={},c=this;s.sp={url:e.mediaURL(n.s.img.mediaID)},(new apn.CRscLoader).load(e.project,s,i)}else a()},xa.exeOnCheckContentLoad=function(e,t,a){return{i:"Image"}},xa.exeOnLoad=function(e,t){function a(a,i){function n(a,n,o){a==n&&(r.ctx.image=c.sp.image,i.data.h=c.sht.image.height,i.data.w=Math.max(1,c.sht.image.width/i.data.cnt),s._loadSpriteSheet(e,t,{ty:"s",s:i.data}))}if(a==t&&i&&i.type&&i.data&&i.data.img&&i.data.img.mediaID&&i.data.cnt&&"simple"==i.type)if(i.data.w&&i.data.h)s._loadSpriteSheet(e,t,{ty:"s",s:i.data});else{var c={};c.sht={url:e.mediaURL(i.data.img.mediaID)},(new apn.CRscLoader).load(e.project,c,n)}}function i(a,i){if(a==n.idStep&&i){if(!r.ctx.frames[i.current])return void e.log(t,"Invalid frame was requested to display by step interface. FrameIndex="+i.current);r.ctx.cur!=i.current&&i.current<r.ctx.frames.length&&(r.ctx.cur=i.current,s._render(e,r,r.ctx.frames[r.ctx.cur]))}}var r=e.wgtTag(t),n=e.wgtGetProperty(t,"cfg"),s=this;if(e.wgtListenProperty(t,"sheet",a),n.idStep){var s=this;e.wgtListenProperty(t,"apxStep",i)}},xa._loadSpriteSheet=function(e,t,a){var i=e.wgtTag(t);if(i){var r=[];if(a.s.tmSet)for(var n=a.s.tmSet.split(";"),s=0;s<n.length;s++)n[s]&&parseInt(n[s])&&(r[s]=parseInt(n[s]));if("s"==a.ty&&a.s.img.mediaID&&a.s.w&&a.s.h&&a.s.cnt&&a.s.tm)for(var c=a.s.cols||a.s.cnt,o=x=bx.$checkNaN(parseInt(a.s.x))||0,d=bx.$checkNaN(parseInt(a.s.y))||0,s=0;s<a.s.cnt;s++)i.ctx.frames[s]={x:x,y:d,w:a.s.w,h:a.s.h,offX:0,offY:0,tm:r[s]?r[s]:a.s.tm},x+=a.s.w,(s+1)%c==0&&(x=o,d+=a.s.h);else if("f"==a.ty&&a.f&&a.f.file&&a.f.file.data){try{var l=JSON.parse(a.f.file.data)}catch(a){e.log(t,"JSON file parsing error:"+a)}if(l&&l.frames){var p=0;for(var s in l.frames)l.frames[s].frame&&(i.ctx.frames.push({x:l.frames[s].frame.x,y:l.frames[s].frame.y,w:l.frames[s].frame.w,h:l.frames[s].frame.h,offX:l.frames[s].spriteSourceSize.x,offY:l.frames[s].spriteSourceSize.y,tm:r[p]?r[p]:a.s.tm}),p++)}}if(i.ctx.useCanvas=!1,2!=e.wgtGetProperty(t,"ver")||bx.HCL.DV.isIE()&&bx.HCL.DV.isIE()<9||(i.ctx.useCanvas=!0),i.ctx.cellInfo=a,i.ctx.useCanvas){if(i.ctx.cell=i.$TAG("canvas",{style:"cursor:inherit;position:absolute;left:0px;top:0px;width:100%;height:100%;"}),i.ctx.cell.width=parseInt(i.style.width),i.ctx.cell.height=parseInt(i.style.height),i.ctx.cvsCtx=i.ctx.cell.getContext("2d"),a.mr&&(1==a.mr?(i.ctx.cell.$CSS("transformOrigin","50% 50%"),i.ctx.cell.$CSS("transform","rotateY(180deg)")):2==a.mr?(i.ctx.cell.$CSS("transformOrigin","50% 50%"),i.ctx.cell.$CSS("transform","rotateX(180deg)")):3==a.mr&&(i.ctx.cell.$CSS("transformOrigin","50% 50%"),i.ctx.cell.$CSS("transform","rotateX(180deg) rotateY(180deg)"))),i.ctx.frames.length){var g=0;void 0!==i.ctx._delayedFrame&&i.ctx._delayedFrame>=0&&i.ctx._delayedFrame<i.ctx.frames.length&&(g=i.ctx._delayedFrame,delete i.ctx._delayedFrame),this._render(e,i,i.ctx.frames[g])}}else if(a.mr?(i.ctx.cellHolderMr=i.ctx.cellHolderMr||i.$TAG("div",{style:"cursor:inherit;width:100%;height:100%;"}),i.ctx.cellHolder=i.ctx.cellHolder||i.ctx.cellHolderMr.$TAG("div"),1==a.mr?(i.ctx.cellHolderMr.$CSS("transformOrigin","50% 50%"),i.ctx.cellHolderMr.$CSS("transform","rotateY(180deg)")):2==a.mr?(i.ctx.cellHolderMr.$CSS("transformOrigin","50% 50%"),i.ctx.cellHolderMr.$CSS("transform","rotateX(180deg)")):3==a.mr&&(i.ctx.cellHolderMr.$CSS("transformOrigin","50% 50%"),i.ctx.cellHolderMr.$CSS("transform","rotateX(180deg) rotateY(180deg)"))):i.ctx.cellHolder=i.ctx.cellHolder||i.$TAG("div"),i.ctx.cellHolder.$A({style:"cursor:inherit;width:"+a.s.w+"px;height:"+a.s.h+"px"}),i.ctx.cell=i.ctx.cell||i.ctx.cellHolder.$TAG("div"),i.ctx.cell.$A({style:"cursor:inherit;position:absolute;left:0px;top:0px;width:"+a.s.w+"px;height:"+a.s.h+"px"}),i.ctx.frames.length){i.tagOnPostResize(e,i),i.ctx.cell.style.backgroundImage="url("+e.mediaURL(a.s.img.mediaID)+")",i.ctx.cell.style.backgroundRepeat="no-repeat";var g=0;void 0!==i.ctx._delayedFrame&&i.ctx._delayedFrame>=0&&i.ctx._delayedFrame<i.ctx.frames.length&&(g=i.ctx._delayedFrame,delete i.ctx._delayedFrame),this._render(e,i,i.ctx.frames[g])}}},xa.exeOnTick=function(e,t,a){var i=e.wgtTag(t);if(i.ctx.frames.length&&0!=i.ctx.action){i.ctx._onceStarted=!0;var r;0==i.ctx.lastTickTime?(i.ctx.cur=0,r=!0):i.ctx.lastTickTime<a&&(r=!0,2==i.ctx.action?i.ctx.cur=(i.ctx.cur+1)%i.ctx.frames.length:(i.ctx.cur++,i.ctx.cur==i.ctx.frames.length&&(i.ctx.cur=0,this._stop(e,i),r=!1))),r&&(i.ctx.lastTickTime=a+i.ctx.frames[i.ctx.cur].tm,this._render(e,i,i.ctx.frames[i.ctx.cur]))}},xa.exePropSet=function(e,t,a,i,r){if("showFrame"==a){if(r)return!0;var n=e.wgtTag(t);n.ctx&&(n.ctx.frames.length?i>0&&i<=n.ctx.frames.length?this._render(e,n,n.ctx.frames[i-1]):e.log(t,"Invalid frame was requested by Widget:run(). FrameIndex="+i):n.ctx._delayedFrame=i-1)}},xa._render=function(e,t,a){if(t.ctx.useCanvas)t.ctx.image&&(t.ctx.cvsCtx.clearRect(0,0,t.ctx.cell.width,t.ctx.cell.height),t.ctx.cvsCtx.drawImage(t.ctx.image,a.x,a.y,a.w,a.h,Math.round(a.offX*(1/e.getZoomX())),Math.round(a.offY*(1/e.getZoomY())),t.ctx.cell.width-Math.round(a.offX*(1/e.getZoomX())),t.ctx.cell.height-Math.round(a.offY*(1/e.getZoomY()))));else{var i=t.ctx.cell.style;i.left!=a.offX+"px"&&(i.left=a.offX+"px"),i.top!=a.offY+"px"&&(i.top=a.offY+"px"),i.width!=a.w+"px"&&(i.width=a.w+"px"),i.height!=a.h+"px"&&(i.height=a.h+"px"),i.backgroundPosition=-a.x+"px "+-a.y+"px"}},xa._stop=function(e,t,a){t.ctx.action=0,t.ctx.lastTickTime=0,a&&t.ctx.frames[0]&&this._render(e,t,t.ctx.frames[0]),t.ctx._onceStarted&&e.fireEvent("animation","End",e.wgtId(t))},xa.edtOnConfig=function(e,t){function a(){if(eduLib.edtInputApplyAll(e,s.tagTab1),eduLib.edtInputApplyAll(e,s.tagTab2),n.s.img.mediaID&&e.wgtSetProperty(t,"apxMediaID",n.s.img.mediaID),"f"==n.ty&&(n.f.edt.w=n.f.edt.h=0,n.f.file.data)){try{var a=JSON.parse(n.f.file.data)}catch(e){}if(a&&a.frames)for(var i in a.frames){n.f.edt.x=a.frames[i].frame.x,n.f.edt.y=a.frames[i].frame.y,n.f.edt.w=a.frames[i].frame.w,n.f.edt.h=a.frames[i].frame.h,n.f.edt.offX=a.frames[i].spriteSourceSize.x,n.f.edt.offY=a.frames[i].spriteSourceSize.y,n.s.w=a.frames[i].sourceSize.w,n.s.h=a.frames[i].sourceSize.h;break}}e.wgtSetProperty(t,"ver",2),e.wgtSetProperty(t,"cfg",n),e.wgtRefreshUI(t)}function i(){"s"==this.value?(eduLib.edtInputShow(e,s.tagTab1,"s",!0),eduLib.edtInputShow(e,s.tagTab1,"f",!1)):(eduLib.edtInputShow(e,s.tagTab1,"f",!0),eduLib.edtInputShow(e,s.tagTab1,"s",!1))}function r(){for(var e in c)c[e]&&(this.id==e?(s[e].style.display="block",s.tagTab.$$(e).style.borderStyle="solid solid none solid"):(s[e].style.display="none",s.tagTab.$$(e).style.borderStyle="none none solid none"));uxWgtShtSprite._uiLastSetupTab=this.id}var n=e.wgtGetProperty(t,"cfg");n.f=n.f||{file:{size:0,data:""},edt:{}};var s,c={tagTab1:!0,tagTab2:!0};if(s=e.dlgDoModal(600,700,a)){var o=apn.CExe.CSS_SETUP_PANE+"height:"+(s.clientHeight-40)+"px";s.tagTab=s.$TAG("div",{style:"position:relative;font-weight:bold;width:100%;height:26px;padding-bottom:14px;"}),s.tagTab.innerHTML='<span id="tagTab1" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"스프라이트",en:"Sprite Sheet",ja:"スプライト"})+'</span><span id="tagTab2" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"스텝 연동",en:"Step Interface",ja:"ステップ連動"})+"</span>"+apn.CExe.CSS_SETUP_TAB_END,s.tagTab.$$("tagTab1").onclick=s.tagTab.$$("tagTab2").onclick=r,s.tagTab1=s.$TAG("div",{style:o}),s.tagTab2=s.$TAG("div",{style:o}),eduLib.edtInputAdd(e,s.tagTab1,{type:"image",title:apn.CExe.GL({ko:"스프라이트 시트 이미지",en:"Sprite sheet image",ja:"スプライトシートの画像"}),value:n.s,key:"img",join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{type:"message",value:"※ "+apn.CExe.GL({ko:"과도한 이미지의 사용은 HTML5 컨텐츠의 성능을 크게 저하시킵니다. 그러한 경우, Video로 제작하거나 Scene Animation으로 편집하는 것이 좋습니다.",en:"Excessive image resources will slow down HTML5 contents. In that case, video or Scene Animation is better.",ja:"過度な画像の使用は、HTML5コンテンツのパフォーマンスを大幅に低下させます。その場合、Videoでの製作や、Scene Animationでの編集をお勧めします。"}),join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{type:"space"}),eduLib.edtInputAdd(e,s.tagTab1,{type:"title",title:apn.CExe.GL({ko:"프레임 구성 정보",en:"Frame information",ja:"フレーム構成情報"})}),eduLib.edtInputAdd(e,s.tagTab1,{type:"select",title:apn.CExe.GL({ko:"스프라이트 시트 구성",en:"Sprite sheet type",ja:"スプライトシートの構成"}),value:n,key:"ty",options:[{title:"Simple",value:"s"},{title:"Adobe Animate - JSON",value:"f"}],onchange:i,join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{type:"number",title:apn.CExe.GL({ko:"프레임 시간",en:"Duration",ja:"フレーム時間"})+"[ms] (m)",value:n.s,key:"tm",join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{type:"text",title:apn.CExe.GL({ko:"프레임 시간 변경",en:"Duration change",ja:"フレーム時間の変更"})+"[ms;...]",value:n.s,key:"tmSet",join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"프레임 셀 너비",en:"Cell width",ja:"フレームセルの幅"})+"[px] (m)",value:n.s,key:"w",join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"프레임 셀 높이",en:"Cell height",ja:"フレームセルの高さ"})+"[px](m)",value:n.s,key:"h",join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"프레임 셀 개수",en:"Cell count",ja:"フレームセル数"})+" (m)",value:n.s,key:"cnt",join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"프레임 셀 열의 수",en:"Column count",ja:"フレームセル列の数"}),value:n.s,key:"cols",comment:"("+apn.CExe.GL({ko:"1개 행으로 구성된 경우, 0을 입력",en:"0 if cells are aligned in one line",ja:"1つの行で構成された場合、0を入力"})+")",join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"시작 X좌표",en:"Start X",ja:"開始X座標"})+"[px]",value:n.s,key:"x",join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"시작 Y좌표",en:"Start Y",ja:"開始Y座標"})+"[px]",value:n.s,key:"y",join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{id:"f",type:"file",title:apn.CExe.GL({ko:"프레임 구성 정보 파일",en:"Frame information file",ja:"フレーム構成情報ファイル"}),value:n.f,key:"file",join:!0}),eduLib.edtInputAdd(e,s.tagTab1,{type:"space"}),eduLib.edtInputAdd(e,s.tagTab1,{type:"title",title:apn.CExe.GL({ko:"대칭 변환",en:"Mirror transformation",ja:"対称変換"})}),eduLib.edtInputAdd(e,s.tagTab1,{type:"select",title:apn.CExe.GL({ko:"방향",en:"Direction",ja:"方向"}),value:n,key:"mr",options:[{title:apn.CExe.GL({ko:"가로",en:"Horizontal",ja:"横"}),value:1},{title:apn.CExe.GL({ko:"세로",en:"Vertical",ja:"縦"}),value:2},{title:apn.CExe.GL({ko:"가로&세로",en:"Both",ja:"横＆縦"}),value:3},{title:apn.CExe.GL({ko:"안함",en:"None",ja:"無効"}),value:0}],join:!0}),uxWgtImgSprite.edtSetupStep(e,t,s.tagTab2,n),void 0!==uxWgtShtSprite._uiLastSetupTab&&s.tagTab.$$(uxWgtShtSprite._uiLastSetupTab)?s.tagTab.$$(uxWgtShtSprite._uiLastSetupTab).onclick():s.tagTab.$$("tagTab1").onclick(),s.tagTab.$$("tagBlank").style.width=s.clientWidth-s.tagTab.$$("tagBlank").offsetLeft-1+"px"}},xa.edtOnFitToSize=function(e,t,a){if(a.cfg.s&&a.cfg.s.w&&a.cfg.s.h)return{w:a.cfg.s.w,h:a.cfg.s.h}},uxWgtShtSprite=xa;
